<!DOCTYPE html>
<html lang="en">
  

  <head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width,minimum-scale=1">

  <title>franzihe area averaged AOD Svalbard</title>
  <meta name="description" content="        HOW TO CITE Hellmuth, Franziska (2019), NEGI-2019 course Report: Evaluation of CMIP6 against ground-based observations and MERRA2, University of Oslo...">

  <link rel="canonical" href="http://nordicesmhub.github.io/NEGI-Abisko-2019/topics/group-2/franzihe_area_averaged_AOD_Svalbard.html">
  <link rel="alternate" type="application/rss+xml" title="eScience for linking Arctic measurements and modeling" href="http://nordicesmhub.github.io/NEGI-Abisko-2019/feed.xml">

  <meta property="og:url"         content="http://nordicesmhub.github.io/NEGI-Abisko-2019/topics/group-2/franzihe_area_averaged_AOD_Svalbard.html" />
<meta property="og:type"        content="article" />
<meta property="og:title"       content="franzihe area averaged AOD Svalbard" />
<meta property="og:description" content="        HOW TO CITE Hellmuth, Franziska (2019), NEGI-2019 course Report: Evaluation of CMIP6 against ground-based observations and MERRA2, University of Oslo..." />
<meta property="og:image"       content="http://nordicesmhub.github.io/NEGI-Abisko-2019/images/logo/zeppelin.png" />

<meta name="twitter:card" content="summary">


  <script type="application/ld+json">
  {
  "@context": "http://schema.org",
  "@type": "NewsArticle",
  "mainEntityOfPage": "http://nordicesmhub.github.io/NEGI-Abisko-2019/topics/group-2/franzihe_area_averaged_AOD_Svalbard.html",
  "headline": "franzihe area averaged AOD Svalbard",
  "datePublished": "2019-11-26T13:34:27+00:00",
  "dateModified": "2019-11-26T13:34:27+00:00",
  "description": "        HOW TO CITE Hellmuth, Franziska (2019), NEGI-2019 course Report: Evaluation of CMIP6 against ground-based observations and MERRA2, University of Oslo...",
  "author": {
    "@type": "Person",
    "name": "Anne Fouilloux"
  },
  "publisher": {
    "@type": "Organization",
    "name": "Data 100 at UC Berkeley",
    "logo": {
      "@type": "ImageObject",
      "url": "http://nordicesmhub.github.io/NEGI-Abisko-2019",
      "width": 60,
      "height": 60
    }
  },
  "image": {
    "@type": "ImageObject",
    "url": "http://nordicesmhub.github.io/NEGI-Abisko-2019",
    "height": 60,
    "width": 60
  }
}

  </script>
  <link rel="stylesheet" href="/NEGI-Abisko-2019/assets/css/styles.css">
  <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css ">

  <!-- <link rel="manifest" href="/manifest.json"> -->
  <!-- <link rel="mask-icon" href="/safari-pinned-tab.svg" color="#efae0a"> -->
  <meta name="msapplication-TileColor" content="#da532c">
  <meta name="msapplication-TileImage" content="/mstile-144x144.png">
  <meta name="theme-color" content="#233947">

  <!-- Favicon -->
  <link rel="shortcut icon" type="image/x-icon" href="/NEGI-Abisko-2019/images/logo/favicon.ico">

  <!-- MathJax Config -->
  <!-- Allow inline math using $ and automatically break long math lines -->
<!-- (mostly) copied from nbconvert configuration -->
<!-- https://github.com/jupyter/nbconvert/blob/master/nbconvert/templates/html/mathjax.tpl -->
<script type="text/x-mathjax-config">
MathJax.Hub.Config({
    tex2jax: {
        inlineMath: [ ['$','$'], ["\\(","\\)"] ],
        displayMath: [ ['$$','$$'], ["\\[","\\]"] ],
        processEscapes: true,
        processEnvironments: true
    },
    // Center justify equations in code and markdown cells. Elsewhere
    // we use CSS to left justify single line equations in code cells.
    displayAlign: 'center',
    "HTML-CSS": {
        styles: {'.MathJax_Display': {"margin": 0}},
        linebreaks: { automatic: true },
    }
});
</script>
<script src='https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS_HTML' async></script>

  <!-- DOM updating function -->
  <script>
const runWhenDOMLoaded = cb => {
  if (document.readyState != 'loading') {
    cb()
  } else if (document.addEventListener) {
    document.addEventListener('DOMContentLoaded', cb)
  } else {
    document.attachEvent('onreadystatechange', function() {
      if (document.readyState == 'complete') cb()
    })
  }
}

// Helper function to init things quickly
initFunction = function(myfunc) {
  runWhenDOMLoaded(myfunc);
  document.addEventListener('turbolinks:load', myfunc);
};
</script>

  <!-- Define some javascript variables that will be useful in other javascript -->
  <script>
    const site_basename = '/NEGI-Abisko-2019';
  </script>

  <!-- Add AnchorJS to let headers be linked -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/anchor-js/4.2.0/anchor.min.js" async></script>
  <script>
const initAnchors = () => {
  if (window.anchors === undefined) {
    setTimeout(initAnchors, 250)
    return
  }
  anchors.add("main h1, main h2, main h3, main h4")
}

initFunction(initAnchors);
</script>


  <!-- Include Turbolinks to make page loads fast -->
  <!-- https://github.com/turbolinks/turbolinks -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/turbolinks/5.2.0/turbolinks.js" async></script>
  <meta name="turbolinks-cache-control" content="no-cache">

  <!-- Selectors for elements on the page -->
  <script>
/**
 * Select various elements on the page for later use
 */

// IDs we'll attach to cells
const codeCellId = index => `codecell${index}`
const inputCellId = index => `inputcell${index}`

pageElements = {}

// All code cells
findCodeCells = function() {
    var codeCells = document.querySelectorAll('div.c-textbook__content > div.highlighter-rouge > div.highlight > pre, div.input_area pre, div.text_cell_render div.highlight pre')
    pageElements['codeCells'] = codeCells;

    codeCells.forEach((codeCell, index) => {
      const id = codeCellId(index)
      codeCell.setAttribute('id', id)
    })
};

initFunction(findCodeCells);

// All cells in general
findInputCells = function() {
    var inputCells = document.querySelectorAll('div.jb_cell')
    pageElements['inputCells'] = inputCells;

    inputCells.forEach((inputCell, index) => {
        const id = inputCellId(index)
        inputCell.setAttribute('id', id)
    })
};

initFunction(findInputCells);
</script>

  <!-- Load nbinteract for widgets -->
  

  <!-- Load Thebelab for interactive widgets -->
  <!-- Include Thebelab for interactive code if it's enabled -->


<!-- Display Thebelab button in each code cell -->
<script>
/**
 * Set up thebelab button for code blocks
 */

const thebelabCellButton = id =>
  `<a id="thebelab-cell-button-${id}" class="btn thebebtn o-tooltip--left" data-tooltip="Interactive Mode">
    <img src="/NEGI-Abisko-2019/assets/images/edit-button.svg" alt="Start interactive mode">
  </a>`


const addThebelabButtonToCodeCells =  () => {

  const codeCells = document.querySelectorAll('div.input_area > div.highlight:not(.output) pre')
  codeCells.forEach((codeCell, index) => {
    const id = codeCellId(index)
    codeCell.setAttribute('id', id)
    if (document.getElementById("thebelab-cell-button-" + id) == null) {
      codeCell.insertAdjacentHTML('afterend', thebelabCellButton(id));
    }
  })
}

initFunction(addThebelabButtonToCodeCells);
</script>



<script type="text/x-thebe-config">
    {
      requestKernel: true,
      binderOptions: {
        repo: 'NordicESMHub/NEGI-Abisko-2019',
        ref: 'master',
      },
      codeMirrorConfig: {
        theme: "abcdef"
      },
      kernelOptions: {
        name: 'python3',
      }
    }
</script>
<script src="https://unpkg.com/thebelab@0.4.0/lib/index.js" async></script>
<script>
    /**
     * Add attributes to Thebelab blocks
     */

    const initThebelab = () => {
        const addThebelabToCodeCells = () => {
            console.log("Adding thebelab to code cells...");
            // If Thebelab hasn't loaded, wait a bit and try again. This
            // happens because we load ClipboardJS asynchronously.
            if (window.thebelab === undefined) {
                setTimeout(addThebelabToCodeCells, 250)
            return
            }

            // If we already detect a Thebelab cell, don't re-run
            if (document.querySelectorAll('div.thebelab-cell').length > 0) {
                return;
            }

            // Find all code cells, replace with Thebelab interactive code cells
            const codeCells = document.querySelectorAll('.input_area pre')
            codeCells.forEach((codeCell, index) => {
                const id = codeCellId(index)
                codeCell.setAttribute('data-executable', 'true')

                // Figure out the language it uses and add this too
                var parentDiv = codeCell.parentElement.parentElement;
                var arrayLength = parentDiv.classList.length;
                for (var ii = 0; ii < arrayLength; ii++) {
                    var parts = parentDiv.classList[ii].split('language-');
                    if (parts.length === 2) {
                        // If found, assign dataLanguage and break the loop
                        var dataLanguage = parts[1];
                        break;
                    }
                }
                codeCell.setAttribute('data-language', dataLanguage)

                // If the code cell is hidden, show it
                var inputCheckbox = document.querySelector(`input#hidebtn${codeCell.id}`);
                if (inputCheckbox !== null) {
                    setCodeCellVisibility(inputCheckbox, 'visible');
                }
            });

            // Remove the event listener from the page so keyboard press doesn't
            // Change page
            document.removeEventListener('keydown', initPageNav)
            keyboardListener = false;

            // Init thebelab
            thebelab.bootstrap();

            // Remove copy buttons since they won't work anymore
            const copyAndThebeButtons = document.querySelectorAll('.copybtn, .thebebtn')
            copyAndThebeButtons.forEach((button, index) => {
                button.remove();
            });

            // Remove outputs since they'll be stale
            const outputs = document.querySelectorAll('.output *, .output')
            outputs.forEach((output, index) => {
                output.remove();
            });
        }

        // Add event listener for the function to modify code cells
        const thebelabButtons = document.querySelectorAll('[id^=thebelab], [id$=thebelab]')
        thebelabButtons.forEach((thebelabButton,index) => {
            if (thebelabButton === null) {
                setTimeout(initThebelab, 250)
                return
            };
            thebelabButton.addEventListener('click', addThebelabToCodeCells);
        });
    }

    // Initialize Thebelab
    initFunction(initThebelab);
</script>



  <!-- Load the auto-generating TOC -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/tocbot/4.4.2/tocbot.min.js" async></script>
<script>
const initToc = () => {
  if (window.tocbot === undefined) {
    setTimeout(initToc, 250)
    return
  }

  // Check whether we have any sidebar content. If not, then show the sidebar earlier.
  var SIDEBAR_CONTENT_TAGS = ['.tag_full_width', '.tag_popout'];
  var sidebar_content_query = SIDEBAR_CONTENT_TAGS.join(', ')
  if (document.querySelectorAll(sidebar_content_query).length === 0) {
    document.querySelector('nav.onthispage').classList.add('no_sidebar_content')
  }

  // Initialize the TOC bot
  tocbot.init({
    tocSelector: 'nav.onthispage',
    contentSelector: '.c-textbook__content',
    headingSelector: 'h2, h3',
    orderedList: false,
    collapseDepth: 6,
    listClass: 'toc__menu',
    activeListItemClass: "",  // Not using
    activeLinkClass: "", // Not using
  });

}
initFunction(initToc);
</script>


  <!-- Google analytics -->
  <script src="/NEGI-Abisko-2019/assets/js/ga.js" async></script>

  <!-- Clipboard copy button -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" async></script>

  <!-- Load custom website scripts -->
  <script src="/NEGI-Abisko-2019/assets/js/scripts.js" async></script>

  <!-- Load custom user CSS and JS  -->
  <script src="/NEGI-Abisko-2019/assets/custom/custom.js" async></script>
  <link rel="stylesheet" href="/NEGI-Abisko-2019/assets/custom/custom.css">

  <!-- Update interact links w/ REST param, is defined in includes so we can use templates -->
  
<script>
/**
  * To auto-embed hub URLs in interact links if given in a RESTful fashion
 */

function getJsonFromUrl(url) {
  var query = url.split('?');
  if (query.length < 2) {
    // No queries so just return false
    return false;
  }
  query = query[1];
  // Collect REST params into a dictionary
  var result = {};
  query.split("&").forEach(function(part) {
    var item = part.split("=");
    result[item[0]] = decodeURIComponent(item[1]);
  });
  return result;
}
    
function dict2param(dict) {
    params = Object.keys(dict).map(function(k) {
        return encodeURIComponent(k) + '=' + encodeURIComponent(dict[k])
    });
    return params.join('&')
}

// Parse a Binder URL, converting it to the string needed for JupyterHub
function binder2Jupyterhub(url) {
  newUrl = {};
  parts = url.split('v2/gh/')[1];
  // Grab the base repo information
  repoinfo = parts.split('?')[0];
  var [org, repo, ref] = repoinfo.split('/');
  newUrl['repo'] = ['https://github.com', org, repo].join('/');
  newUrl['branch'] = ref
  // Grab extra parameters passed
  params = getJsonFromUrl(url);
  if (params['filepath'] !== undefined) {
    newUrl['subPath'] = params['filepath']
  }
  return dict2param(newUrl);
}

// Filter out potentially unsafe characters to prevent xss
function safeUrl(url)
{
   return String(encodeURIComponent(url))
            .replace(/&/g, '&amp;')
            .replace(/"/g, '&quot;')
            .replace(/'/g, '&#39;')
            .replace(/</g, '&lt;')
            .replace(/>/g, '&gt;');
}

function addParamToInternalLinks(hub) {
  var links = document.querySelectorAll("a").forEach(function(link) {
    var href = link.href;
    // If the link is an internal link...
    if (href.search("http://nordicesmhub.github.io") !== -1 || href.startsWith('/') || href.search("127.0.0.1:") !== -1) {
      // Assume we're an internal link, add the hub param to it
      var params = getJsonFromUrl(href);
      if (params !== false) {
        // We have REST params, so append a new one
        params['jupyterhub'] = hub;
      } else {
        // Create the REST params
        params = {'jupyterhub': hub};
      }
      // Update the link
      var newHref = href.split('?')[0] + '?' + dict2param(params);
      link.setAttribute('href', decodeURIComponent(newHref));
    }
  });
  return false;
}


// Update interact links
function updateInteractLink() {
    // hack to make this work since it expects a ? in the URL
    rest = getJsonFromUrl("?" + location.search.substr(1));
    jupyterHubUrl = rest['jupyterhub'];
    var hubType = null;
    var hubUrl = null;
    if (jupyterHubUrl !== undefined) {
      hubType = 'jupyterhub';
      hubUrl = jupyterHubUrl;
    }

    if (hubType !== null) {
      // Sanitize the hubUrl
      hubUrl = safeUrl(hubUrl);

      // Add HTTP text if omitted
      if (hubUrl.indexOf('http') < 0) {hubUrl = 'http://' + hubUrl;}
      var interactButtons = document.querySelectorAll("button.interact-button")
      var lastButton = interactButtons[interactButtons.length-1];
      var link = lastButton.parentElement;

      // If we've already run this, skip the link updating
      if (link.nextElementSibling !== null) {
        return;
      }

      // Update the link and add context div
      var href = link.getAttribute('href');
      if (lastButton.id === 'interact-button-binder') {
        // If binder links exist, we need to re-work them for jupyterhub
        if (hubUrl.indexOf('http%3A%2F%2Flocalhost') > -1) {
          // If localhost, assume we're working from a local Jupyter server and remove `/hub`
          first = [hubUrl, 'git-sync'].join('/')
        } else {
          first = [hubUrl, 'hub', 'user-redirect', 'git-sync'].join('/')
        }
        href = first + '?' + binder2Jupyterhub(href);
      } else {
        // If interact button isn't binderhub, assume it's jupyterhub
        // If JupyterHub links, we only need to replace the hub url
        href = href.replace("http://abisko.uiogeo-apps.sigma2.no", hubUrl);
        if (hubUrl.indexOf('http%3A%2F%2Flocalhost') > -1) {
          // Assume we're working from a local Jupyter server and remove `/hub`
          href = href.replace("/hub/user-redirect", "");
        }
      }
      link.setAttribute('href', decodeURIComponent(href));

      // Add text after interact link saying where we're launching
      hubUrlNoHttp = decodeURIComponent(hubUrl).replace('http://', '').replace('https://', '');
      link.insertAdjacentHTML('afterend', '<div class="interact-context">on ' + hubUrlNoHttp + '</div>');

      // Update internal links so we retain the hub url
      addParamToInternalLinks(hubUrl);
    }
}

runWhenDOMLoaded(updateInteractLink)
document.addEventListener('turbolinks:load', updateInteractLink)
</script>


  <!-- Lunr search code - will only be executed on the /search page -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/lunr.js/2.3.6/lunr.min.js" async></script>
  <script>var initQuery = function() {
  // See if we have a search box
  var searchInput = document.querySelector('input#lunr_search');
  if (searchInput === null) {
    return;
  }

  // Function to parse our lunr cache
  var idx = lunr(function () {
    this.field('title')
    this.field('excerpt')
    this.field('categories')
    this.field('tags')
    this.ref('id')

    this.pipeline.remove(lunr.trimmer)

    for (var item in store) {
      this.add({
        title: store[item].title,
        excerpt: store[item].excerpt,
        categories: store[item].categories,
        tags: store[item].tags,
        id: item
      })
    }
  });

  // Run search upon keyup
  searchInput.addEventListener('keyup', function () {
    var resultdiv = document.querySelector('#results');
    var query = document.querySelector("input#lunr_search").value.toLowerCase();
    var result =
      idx.query(function (q) {
        query.split(lunr.tokenizer.separator).forEach(function (term) {
          q.term(term, { boost: 100 })
          if(query.lastIndexOf(" ") != query.length-1){
            q.term(term, {  usePipeline: false, wildcard: lunr.Query.wildcard.TRAILING, boost: 10 })
          }
          if (term != ""){
            q.term(term, {  usePipeline: false, editDistance: 1, boost: 1 })
          }
        })
      });

      // Empty the results div
      while (resultdiv.firstChild) {
        resultdiv.removeChild(resultdiv.firstChild);
      }

    resultdiv.insertAdjacentHTML('afterbegin', '<p class="results__found">'+result.length+' Result(s) found</p>');
    for (var item in result) {
      var ref = result[item].ref;
      if(store[ref].teaser){
        var searchitem =
          '<div class="list__item">'+
            '<article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">'+
              '<h2 class="archive__item-title" itemprop="headline">'+
                '<a href="'+store[ref].url+'" rel="permalink">'+store[ref].title+'</a>'+
              '</h2>'+
              '<div class="archive__item-teaser">'+
                '<img src="'+store[ref].teaser+'" alt="">'+
              '</div>'+
              '<p class="archive__item-excerpt" itemprop="description">'+store[ref].excerpt.split(" ").splice(0,20).join(" ")+'...</p>'+
            '</article>'+
          '</div>';
      }
      else{
    	  var searchitem =
          '<div class="list__item">'+
            '<article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">'+
              '<h2 class="archive__item-title" itemprop="headline">'+
                '<a href="'+store[ref].url+'" rel="permalink">'+store[ref].title+'</a>'+
              '</h2>'+
              '<p class="archive__item-excerpt" itemprop="description">'+store[ref].excerpt.split(" ").splice(0,20).join(" ")+'...</p>'+
            '</article>'+
          '</div>';
      }
      resultdiv.insertAdjacentHTML('beforeend', searchitem);
    }
  });
};

initFunction(initQuery);
</script>

  <!-- Load JS that depends on site variables -->
  <script>
/**
 * Set up copy/paste for code blocks
 */
const clipboardButton = id =>
  `<a id="copy-button-${id}" class="btn copybtn o-tooltip--left" data-tooltip="Copy" data-clipboard-target="#${id}">
    <img src="/NEGI-Abisko-2019/assets/images/copy-button.svg" alt="Copy to clipboard">
  </a>`

// Clears selected text since ClipboardJS will select the text when copying
const clearSelection = () => {
  if (window.getSelection) {
    window.getSelection().removeAllRanges()
  } else if (document.selection) {
    document.selection.empty()
  }
}

// Changes tooltip text for two seconds, then changes it back
const temporarilyChangeTooltip = (el, newText) => {
  const oldText = el.getAttribute('data-tooltip')
  el.setAttribute('data-tooltip', newText)
  setTimeout(() => el.setAttribute('data-tooltip', oldText), 2000)
}

const addCopyButtonToCodeCells = () => {
  // If ClipboardJS hasn't loaded, wait a bit and try again. This
  // happens because we load ClipboardJS asynchronously.
  if (window.ClipboardJS === undefined) {
    setTimeout(addCopyButtonToCodeCells, 250)
    return
  }

  pageElements['codeCells'].forEach((codeCell) => {
    const id = codeCell.getAttribute('id')
    if (document.getElementById("copy-button" + id) == null) {
      codeCell.insertAdjacentHTML('afterend', clipboardButton(id));
    }
  })

  const clipboard = new ClipboardJS('.copybtn')
  clipboard.on('success', event => {
    clearSelection()
    temporarilyChangeTooltip(event.trigger, 'Copied!')
  })

  clipboard.on('error', event => {
    temporarilyChangeTooltip(event.trigger, 'Failed to copy')
  })

  // Get rid of clipboard before the next page visit to avoid memory leak
  document.addEventListener('turbolinks:before-visit', () =>
    clipboard.destroy()
  )
}

initFunction(addCopyButtonToCodeCells);
</script>


  <!-- Hide cell code -->
  <script>
    /**
    Add buttons to hide code cells
    */


    var setCodeCellVisibility = function (inputField, kind) {
        // Update the image and class for hidden
        var id = inputField.getAttribute('data-id');
        var codeCell = document.querySelector(`#${id} div.highlight`);

        if (kind === "visible") {
            codeCell.classList.remove('hidden');
            inputField.checked = true;
        } else {
            codeCell.classList.add('hidden');
            inputField.checked = false;
        }
    }

    var toggleCodeCellVisibility = function (event) {
        // The label is clicked, and now we decide what to do based on the input field's clicked status
        if (event.target.tagName === "LABEL") {
            var inputField = event.target.previousElementSibling;
        } else {
            // It is the span inside the target
            var inputField = event.target.parentElement.previousElementSibling;
        }

        if (inputField.checked === true) {
            setCodeCellVisibility(inputField, "visible");
        } else {
            setCodeCellVisibility(inputField, "hidden");
        }
    }


    // Button constructor
    const hideCodeButton = id => `<input class="hidebtn" type="checkbox" id="hidebtn${id}" data-id="${id}"><label title="Toggle cell" for="hidebtn${id}" class="plusminus"><span class="pm_h"></span><span class="pm_v"></span></label>`

    var addHideButton = function () {
        // If a hide button is already added, don't add another
        if (document.querySelector('div.tag_hide_input input') !== null) {
            return;
        }

        // Find the input cells and add a hide button
        pageElements['inputCells'].forEach(function (inputCell) {
            if (!inputCell.classList.contains("tag_hide_input")) {
                // Skip the cell if it doesn't have a hidecode class
                return;
            }

            const id = inputCell.getAttribute('id')

            // Insert the button just inside the end of the next div
            inputCell.querySelector('div.input').insertAdjacentHTML('beforeend', hideCodeButton(id))

            // Set up the visibility toggle
            hideLink = document.querySelector(`#${id} div.inner_cell + input + label`);
            hideLink.addEventListener('click', toggleCodeCellVisibility)
        });
    }


    // Initialize the hide buttos
    var initHiddenCells = function () {
        // Add hide buttons to the cells
        addHideButton();

        // Toggle the code cells that should be hidden
        document.querySelectorAll('div.tag_hide_input input').forEach(function (item) {
            setCodeCellVisibility(item, 'hidden');
            item.checked = true;
        })
    }

    initFunction(initHiddenCells);

</script>

  <!-- Printing the screen -->
  <!-- Include nbinteract for interactive widgets -->
<script src="https://printjs-4de6.kxcdn.com/print.min.js" async></script>
<script>
printContent = () => {
    // MathJax displays a second version of any math for assistive devices etc.
    // This prevents double-rendering in the PDF output.
    var ignoreAssistList = [];
    assistives = document.querySelectorAll('.MathJax_Display span.MJX_Assistive_MathML').forEach((element, index) => {
        var thisId = 'MathJax-assistive-' + index.toString();
        element.setAttribute('id', thisId);
        ignoreAssistList.push(thisId)
    });

    // Print the actual content object
    printJS({
        printable: 'textbook_content',
        type: 'html',
        css: "/NEGI-Abisko-2019/assets/css/styles.css",
        scanStyles: false,
        targetStyles: ["*"],
        ignoreElements: ignoreAssistList
    })
};

initPrint = () => {
    document.querySelector('#interact-button-print').addEventListener('click', printContent)
}

initFunction(initPrint)
</script>

</head>

  <body>
    <!-- .js-show-sidebar shows sidebar by default -->
    <div id="js-textbook" class="c-textbook js-show-sidebar">
      



<nav id="js-sidebar" class="c-textbook__sidebar">
  <a href="https://www.aces.su.se/research/projects/course-series-on-climate-science-at-high-latitudes/"><img src="/NEGI-Abisko-2019/images/logo/zeppelin.png" class="textbook_logo" id="sidebar-logo" data-turbolinks-permanent/></a>
  <h2 class="c-sidebar__title">eScience for linking Arctic measurements and modeling</h2>
  <ul class="c-sidebar__chapters">
    
      
      

      
      

      
      
      <li class="c-sidebar__chapter">
        <a class="c-sidebar__entry "
          href="/NEGI-Abisko-2019/intro.html"
        >
          
          Home
        </a>

        
      </li>

      
    
      
      
        <li><h2 class="c-sidebar__title">Themes and group topics</li>
        
      
      

      
      

      
      
      <li class="c-sidebar__chapter">
        <a class="c-sidebar__entry "
          href="/NEGI-Abisko-2019/topics/report/intro.html"
        >
          
            1.
          
          Report guidelines
        </a>

        

          
          
          
          

          

          <ul class="c-sidebar__sections u-hidden-visually">
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/NEGI-Abisko-2019/topics/report/Peer-review-matching_timeline_and_guidelines.html"
                >
                  
                    1.1
                  
                  Peer review matching timeline notebook
                </a>

                
                

              </li>
              
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/NEGI-Abisko-2019/topics/report/presentation.html"
                >
                  
                    1.2
                  
                  Notebook for presentation
                </a>

                
                

              </li>
              
            
          </ul>
        
      </li>

      
    
      
      

      
      

      
      
      <li class="c-sidebar__chapter">
        <a class="c-sidebar__entry "
          href="/NEGI-Abisko-2019/topics/group-1/intro.html"
        >
          
            2.
          
          Group-1
        </a>

        

          
          
          
          

          

          <ul class="c-sidebar__sections u-hidden-visually">
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/NEGI-Abisko-2019/topics/group-1/libe05_test.html"
                >
                  
                    2.1
                  
                  libe05 project
                </a>

                
                

              </li>
              
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/NEGI-Abisko-2019/topics/group-1/Luis-s21_Project.html"
                >
                  
                    2.2
                  
                  Luis-s21 project
                </a>

                
                

              </li>
              
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/NEGI-Abisko-2019/topics/group-1/slijeci_project.html"
                >
                  
                    2.3
                  
                  Slijeci project
                </a>

                
                

              </li>
              
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/NEGI-Abisko-2019/topics/group-1/tuulivarenka_zeppelin2010_2015_particleplot.html"
                >
                  
                    2.4
                  
                  Tuulivarenka project
                </a>

                
                

              </li>
              
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/NEGI-Abisko-2019/topics/group-1/presentations/intro.html"
                >
                  
                    2.5
                  
                  Presentations
                </a>

                
                

              </li>
              
            
          </ul>
        
      </li>

      
    
      
      

      
      

      
      
      <li class="c-sidebar__chapter">
        <a class="c-sidebar__entry "
          href="/NEGI-Abisko-2019/topics/group-2/intro.html"
        >
          
            3.
          
          Group-2
        </a>

        

          
          
          
          

          

          <ul class="c-sidebar__sections ">
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/NEGI-Abisko-2019/topics/group-2/aod_div.html"
                >
                  
                    3.1
                  
                  AOD div
                </a>

                
                

              </li>
              
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/NEGI-Abisko-2019/topics/group-2/lassekva.html"
                >
                  
                    3.2
                  
                  lassekva Project
                </a>

                
                

              </li>
              
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry c-sidebar__entry--active"
                  href="/NEGI-Abisko-2019/topics/group-2/franzihe_area_averaged_AOD_Svalbard.html"
                >
                  
                    3.3
                  
                  franzihe area averaged AOD Svalbard
                </a>

                
                
                  
                  

                  <li class="c-sidebar__subsection">
                    <a class="c-sidebar__entry "
                      href="/NEGI-Abisko-2019/topics/group-2/franzihe_intermediate_pres.html"
                    >
                      
                        3.3.1
                        
                      
                      Franzihe presentation
                    </a>
                

              </li>
              
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/NEGI-Abisko-2019/topics/group-2/marekrataj_read_data.html"
                >
                  
                    3.4
                  
                  Marekrataj read data
                </a>

                
                

              </li>
              
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/NEGI-Abisko-2019/topics/group-2/sofiemt_dmp.html"
                >
                  
                    3.5
                  
                  Sofiemt DMP
                </a>

                
                

              </li>
              
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/NEGI-Abisko-2019/topics/group-2/presentations/intro.html"
                >
                  
                    3.6
                  
                  Presentations
                </a>

                
                

              </li>
              
            
          </ul>
        
      </li>

      
    
      
      

      
      

      
      
      <li class="c-sidebar__chapter">
        <a class="c-sidebar__entry "
          href="/NEGI-Abisko-2019/topics/group-3/intro.html"
        >
          
            4.
          
          Group-3
        </a>

        

          
          
          
          

          

          <ul class="c-sidebar__sections u-hidden-visually">
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/NEGI-Abisko-2019/topics/group-3/data-to-use.html"
                >
                  
                    4.1
                  
                  Data to use
                </a>

                
                

              </li>
              
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/NEGI-Abisko-2019/topics/group-3/DeleteMaria.html"
                >
                  
                    4.2
                  
                  Maria's project
                </a>

                
                

              </li>
              
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/NEGI-Abisko-2019/topics/group-3/stinsage_temperature.html"
                >
                  
                    4.3
                  
                  Stinsage temperature
                </a>

                
                

              </li>
              
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/NEGI-Abisko-2019/topics/group-3/aod_johan.html"
                >
                  
                    4.4
                  
                  AOD johan
                </a>

                
                

              </li>
              
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/NEGI-Abisko-2019/topics/group-3/presentations/intro.html"
                >
                  
                    4.5
                  
                  Presentations
                </a>

                
                

              </li>
              
            
          </ul>
        
      </li>

      
    
      
      

      
      

      
      
      <li class="c-sidebar__chapter">
        <a class="c-sidebar__entry "
          href="/NEGI-Abisko-2019/topics/group-4/intro.html"
        >
          
            5.
          
          Group-4
        </a>

        

          
          
          
          

          

          <ul class="c-sidebar__sections u-hidden-visually">
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/NEGI-Abisko-2019/topics/group-4/dinastabell_DMP.html"
                >
                  
                    5.1
                  
                  Dinastabell DMP
                </a>

                
                

              </li>
              
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/NEGI-Abisko-2019/topics/group-4/olga_firus_test.html"
                >
                  
                    5.2
                  
                  Olga firus test
                </a>

                
                

              </li>
              
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/NEGI-Abisko-2019/topics/group-4/dominichr1_test.html"
                >
                  
                    5.3
                  
                  Dominichr1 Test
                </a>

                
                

              </li>
              
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/NEGI-Abisko-2019/topics/group-4/sigridjb_topic_presentation.html"
                >
                  
                    5.4
                  
                  Sigridjb topic presentation
                </a>

                
                
                  
                  

                  <li class="c-sidebar__subsection">
                    <a class="c-sidebar__entry "
                      href="/NEGI-Abisko-2019/topics/group-4/SizeDistNotebooks/Alert_sizedist.html"
                    >
                      
                        5.4.1
                        
                      
                      Alert Size distribution
                    </a>
                
                  
                  

                  <li class="c-sidebar__subsection">
                    <a class="c-sidebar__entry "
                      href="/NEGI-Abisko-2019/topics/group-4/SizeDistNotebooks/Tiksi_sizedist.html"
                    >
                      
                        5.4.2
                        
                      
                      Tiksi Size distribution
                    </a>
                
                  
                  

                  <li class="c-sidebar__subsection">
                    <a class="c-sidebar__entry "
                      href="/NEGI-Abisko-2019/topics/group-4/SizeDistNotebooks/Nord_sizedist.html"
                    >
                      
                        5.4.3
                        
                      
                      Nord Size distribution
                    </a>
                
                  
                  

                  <li class="c-sidebar__subsection">
                    <a class="c-sidebar__entry "
                      href="/NEGI-Abisko-2019/topics/group-4/SizeDistNotebooks/Zeppelin_sizedist.html"
                    >
                      
                        5.4.4
                        
                      
                      Zeppelin Size distribution
                    </a>
                

              </li>
              
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/NEGI-Abisko-2019/topics/group-4/NILU_size_distr_from_ebas.html"
                >
                  
                    5.5
                  
                  NILU size distribution from EBAS
                </a>

                
                

              </li>
              
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/NEGI-Abisko-2019/topics/group-4/references.html"
                >
                  
                    5.6
                  
                  References
                </a>

                
                

              </li>
              
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/NEGI-Abisko-2019/topics/group-4/presentations/intro.html"
                >
                  
                    5.7
                  
                  Presentations
                </a>

                
                

              </li>
              
            
          </ul>
        
      </li>

      
    
      
      
        <li><h2 class="c-sidebar__title">Course program</li>
        
      
      

      
      

      
      
      <li class="c-sidebar__chapter">
        <a class="c-sidebar__entry "
          href="/NEGI-Abisko-2019/tools/tools.html"
        >
          
          Tools
        </a>

        
      </li>

      
    
      
      
        <li class="c-sidebar__divider"></li>
        
      
      

      
      

      
      
      <li class="c-sidebar__chapter">
        <a class="c-sidebar__entry "
          href="/NEGI-Abisko-2019/setup/preparation.html"
        >
          
          Course preparation
        </a>

        

          
          
          
          

          

          <ul class="c-sidebar__sections ">
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/NEGI-Abisko-2019/setup/setup.html"
                >
                  
                  Setup
                </a>

                
                
                  
                  

                  <li class="c-sidebar__subsection">
                    <a class="c-sidebar__entry "
                      href="/NEGI-Abisko-2019/setup/laptop_setup.html"
                    >
                      
                      Laptop setup
                    </a>
                
                  
                  

                  <li class="c-sidebar__subsection">
                    <a class="c-sidebar__entry "
                      href="/NEGI-Abisko-2019/setup/jupyterhub_setup.html"
                    >
                      
                      Jupyterhub setup
                    </a>
                

              </li>
              
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="https://jupyter.org/try.html"
                >
                  
                  Get ready with Jupyter
                </a>

                
                

              </li>
              
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="https://swcarpentry.github.io/python-novice-gapminder/index.html"
                >
                  
                  Get ready with Python
                </a>

                
                

              </li>
              
            
          </ul>
        
      </li>

      
    
      
      

      
      

      
      
      <li class="c-sidebar__chapter">
        <a class="c-sidebar__entry "
          href="/NEGI-Abisko-2019/contributing/os_contribution.html"
        >
          
          Course Contribution
        </a>

        

          
          
          
          

          

          <ul class="c-sidebar__sections u-hidden-visually">
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/NEGI-Abisko-2019/contributing/newcomers.html"
                >
                  
                  New contributors
                </a>

                
                

              </li>
              
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/NEGI-Abisko-2019/contributing/CONTRIBUTING.html"
                >
                  
                  Contribute to Open Science projects
                </a>

                
                

              </li>
              
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/NEGI-Abisko-2019/setup/Abisko_prep.html"
                >
                  
                  Notebook example
                </a>

                
                

              </li>
              
            
          </ul>
        
      </li>

      
    
      
      

      
      

      
      
      <li class="c-sidebar__chapter">
        <a class="c-sidebar__entry "
          href="/NEGI-Abisko-2019/training/example_notebooks/example_notebooks.html"
        >
          
          Example notebook report
        </a>

        

          
          
          
          

          

          <ul class="c-sidebar__sections u-hidden-visually">
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/NEGI-Abisko-2019/training/example_notebooks/NeGIcourse_2018_LinnKarlsson.html"
                >
                  
                  Linn Karlsson, Sizedistributions in NorESM
                </a>

                
                

              </li>
              
            
          </ul>
        
      </li>

      
    
      
      

      
      

      
      
      <li class="c-sidebar__chapter">
        <a class="c-sidebar__entry "
          href="/NEGI-Abisko-2019/training/intro.html"
        >
          
          Learning resources
        </a>

        

          
          
          
          

          

          <ul class="c-sidebar__sections ">
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/NEGI-Abisko-2019/training/presentations.html"
                >
                  
                  Presentations
                </a>

                
                

              </li>
              
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="https://nordicesmhub.github.io/tutorials/programming/index.html"
                >
                  
                  Programming
                </a>

                
                

              </li>
              
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="https://nordicesmhub.github.io/tutorials/science/index.html"
                >
                  
                  E-Science
                </a>

                
                

              </li>
              
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/NEGI-Abisko-2019/training/github/intro_github.html"
                >
                  
                  Getting started with Git/Github
                </a>

                
                
                  
                  

                  <li class="c-sidebar__subsection">
                    <a class="c-sidebar__entry "
                      href="/NEGI-Abisko-2019/training/github/synchronise_github.html"
                    >
                      
                      Synchronize your fork github repository
                    </a>
                
                  
                  

                  <li class="c-sidebar__subsection">
                    <a class="c-sidebar__entry "
                      href="/NEGI-Abisko-2019/training/github/git_pull_requests.html"
                    >
                      
                      Git pull request explained
                    </a>
                

              </li>
              
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/NEGI-Abisko-2019/training/visualize/intro.html"
                >
                  
                  Visualize in Python
                </a>

                
                

              </li>
              
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/NEGI-Abisko-2019/training/python_examples.html"
                >
                  
                  Python examples
                </a>

                
                
                  
                  

                  <li class="c-sidebar__subsection">
                    <a class="c-sidebar__entry "
                      href="/NEGI-Abisko-2019/training/visualize/zeppelin_size_dist.html"
                    >
                      
                      Aerosol distribution plotting
                    </a>
                
                  
                  

                  <li class="c-sidebar__subsection">
                    <a class="c-sidebar__entry "
                      href="/NEGI-Abisko-2019/training/example_NorthPolarStereo_projection.html"
                    >
                      
                      Example NorthPolarStereo_projection
                    </a>
                
                  
                  

                  <li class="c-sidebar__subsection">
                    <a class="c-sidebar__entry "
                      href="/NEGI-Abisko-2019/training/Example_model_global_arctic_average.html"
                    >
                      
                      Example Weighted/masked average
                    </a>
                
                  
                  

                  <li class="c-sidebar__subsection">
                    <a class="c-sidebar__entry "
                      href="/NEGI-Abisko-2019/training/gridded_model_data_dask_rolling_mean.html"
                    >
                      
                      Gridded model data dask rolling mean
                    </a>
                
                  
                  

                  <li class="c-sidebar__subsection">
                    <a class="c-sidebar__entry "
                      href="/NEGI-Abisko-2019/training/dask_kernel/dask_kernel.html"
                    >
                      
                      Dask kernel example
                    </a>
                
                  
                  

                  <li class="c-sidebar__subsection">
                    <a class="c-sidebar__entry "
                      href="/NEGI-Abisko-2019/training/example_notebooks/from_ebas_using_pydap.html"
                    >
                      
                      Get EBAS data with pydap
                    </a>
                

              </li>
              
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/NEGI-Abisko-2019/training/pyaerocom/intro.html"
                >
                  
                  Pyaerocom
                </a>

                
                
                  
                  

                  <li class="c-sidebar__subsection">
                    <a class="c-sidebar__entry "
                      href="/NEGI-Abisko-2019/training/pyaerocom/jgliss_intro_model_evaluation_pyaerocom.html"
                    >
                      
                      pyaerocom jupyter notebook
                    </a>
                
                  
                  

                  <li class="c-sidebar__subsection">
                    <a class="c-sidebar__entry "
                      href="/NEGI-Abisko-2019/training/pyaerocom/example_ebas_read.html"
                    >
                      
                      pyaerocom EBAS example
                    </a>
                
                  
                  

                  <li class="c-sidebar__subsection">
                    <a class="c-sidebar__entry "
                      href="/NEGI-Abisko-2019/training/pyaerocom/HOWTO_find_EBAS_files.html"
                    >
                      
                      How to find EBAS files
                    </a>
                
                  
                  

                  <li class="c-sidebar__subsection">
                    <a class="c-sidebar__entry "
                      href="/NEGI-Abisko-2019/training/pyaerocom/HOWTO_read_EBAS_files.html"
                    >
                      
                      How to read EBAS files
                    </a>
                
                  
                  

                  <li class="c-sidebar__subsection">
                    <a class="c-sidebar__entry "
                      href="/NEGI-Abisko-2019/training/pyaerocom/HOWTO_handle_large_files.html"
                    >
                      
                      How to handle large files
                    </a>
                
                  
                  

                  <li class="c-sidebar__subsection">
                    <a class="c-sidebar__entry "
                      href="/NEGI-Abisko-2019/training/pyaerocom/example_cmip6_colocation.html"
                    >
                      
                      Example CMIP6 colocation
                    </a>
                
                  
                  

                  <li class="c-sidebar__subsection">
                    <a class="c-sidebar__entry "
                      href="/NEGI-Abisko-2019/training/pyaerocom/example_aas_etal_read.html"
                    >
                      
                      Example aas etal read
                    </a>
                
                  
                  

                  <li class="c-sidebar__subsection">
                    <a class="c-sidebar__entry "
                      href="/NEGI-Abisko-2019/training/pyaerocom/EXAMPLE_EBAS_arctic_so4_concentrations.html"
                    >
                      
                      Example EBAS artic SO4 concentrations
                    </a>
                
                  
                  

                  <li class="c-sidebar__subsection">
                    <a class="c-sidebar__entry "
                      href="/NEGI-Abisko-2019/training/pyaerocom/pyaerocom_gridded_gridded.html"
                    >
                      
                      How to compare model with model (gridded-gridded)
                    </a>
                
                  
                  

                  <li class="c-sidebar__subsection">
                    <a class="c-sidebar__entry "
                      href="/NEGI-Abisko-2019/training/pyaerocom/local_pyaerocom.html"
                    >
                      
                      Install pyaerocom dev
                    </a>
                

              </li>
              
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/NEGI-Abisko-2019/training/CMIP6_data.html"
                >
                  
                  CMIP6 data
                </a>

                
                
                  
                  

                  <li class="c-sidebar__subsection">
                    <a class="c-sidebar__entry "
                      href="/NEGI-Abisko-2019/training/CMIP6_example.html"
                    >
                      
                      Plotting CMIP6 data
                    </a>
                
                  
                  

                  <li class="c-sidebar__subsection">
                    <a class="c-sidebar__entry "
                      href="/NEGI-Abisko-2019/training/CMIP6_dask.html"
                    >
                      
                      CMIP6 data with dask cluster
                    </a>
                
                  
                  

                  <li class="c-sidebar__subsection">
                    <a class="c-sidebar__entry "
                      href="/NEGI-Abisko-2019/training/example_search_cmip6_historical.html"
                    >
                      
                      Search CMIP6 historical data
                    </a>
                

              </li>
              
            
          </ul>
        
      </li>

      
    
      
      
        <li class="c-sidebar__divider"></li>
        
      
      

      
      

      
      
      <li class="c-sidebar__chapter">
        <a class="c-sidebar__entry "
          href="https://github.com/NordicESMHub/NEGI-Abisko-2019"
        >
          
          GitHub repository
        </a>

        
      </li>

      
    
  </ul>
  <p class="sidebar_footer">Powered by <a href="https://github.com/jupyter/jupyter-book">Jupyter Book</a></p>
</nav>

      
      <div class="c-topbar" id="top-navbar">
  <!-- We show the sidebar by default so we use .is-active -->
  <div class="c-topbar__buttons">
    <button
      id="js-sidebar-toggle"
      class="hamburger hamburger--arrowalt is-active"
    >
      <span class="hamburger-box">
        <span class="hamburger-inner"></span>
      </span>
    </button>
    <div class="buttons">
<div class="download-buttons-dropdown">
    <button id="dropdown-button-trigger" class="interact-button"><i class="fa fa-download"></i></button>
    <div class="download-buttons">
        <a href="/NEGI-Abisko-2019/content/topics/group-2/franzihe_area_averaged_AOD_Svalbard.ipynb" download>
        <button id="interact-button-download" class="interact-button">ORIG</button>
        </a>
        
        <a id="interact-button-print"><button id="interact-button-download" class="interact-button">PDF</button></a>
    </div>
</div>

  <button id="interact-button-thebelab" class="interact-button">Thebelab</button>

  
  






<a href="https://mybinder.org/v2/gh/NordicESMHub/NEGI-Abisko-2019/master?urlpath=lab/tree/content%2Ftopics%2Fgroup-2%2Ffranzihe_area_averaged_AOD_Svalbard.ipynb"><button class="interact-button" id="interact-button-binder"><img class="interact-button-logo" src="/NEGI-Abisko-2019/assets/images/logo_binder.svg" alt="Interact" />Interact</button></a>
  





<a href="http://abisko.uiogeo-apps.sigma2.no/hub/user-redirect/git-pull?repo=https://github.com//NordicESMHub/NEGI-Abisko-2019&amp;branch=master&amp;subPath=content%2Ftopics%2Fgroup-2%2Ffranzihe_area_averaged_AOD_Svalbard.ipynb&amp;app=lab"><button class="interact-button" id="interact-button-jupyterhub"><img class="interact-button-logo" src="/NEGI-Abisko-2019/assets/images/logo_jupyterhub.svg" alt="Interact" />JupyterHub</button></a>




</div>

  </div>
  <!-- Empty sidebar placeholder that we'll auto-fill with javascript -->
  <aside class="sidebar__right">
    <header><h4 class="nav__title"><i class="fa fa-list"></i>   On this page</h4></header>
    <nav class="onthispage">
    </nav>
  </aside>
  <a href="/NEGI-Abisko-2019/search.html" class="topbar-right-button" id="search-button"><i class="fa fa-search"></i></a>
</div>

      <main class="c-textbook__page" tabindex="-1">
            <div class="c-textbook__content" id="textbook_content">
                  <main class="jupyter-page">
    <div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="HOW-TO-CITE">HOW TO CITE<a class="anchor-link" href="#HOW-TO-CITE"> </a></h1><p>Hellmuth, Franziska (2019), NEGI-2019 course Report: Evaluation of CMIP6 against ground-based observations and MERRA2, University of Oslo, franziska.hellmuth@geo.uio.no</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1>Intercomparison between CMIP6 models, MERRA2 satellite-retrieved reanalysis data and AERONET of aerosol optical depth</h1><p><br>
<font size=4>
    <p><b> Franziska Hellmuth</b></p>
    <p><i> NEGI course 2019 - eScience for linking Arctic measurements and modeling</i></p>
    <p><b> Group assistants: Paul Glantz, Ksenia Tabakova, Jonas Gliss</b></p>
    </font></p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Abstract">Abstract<a class="anchor-link" href="#Abstract"> </a></h1><p>We compare aerosol optical depth (AOD) from 12 Coupled Model Intercomparison Project 6 (CMIP6) models with Modern-Era Retrospective analysis for Research and Applications 2 (MERRA2) and ground-based observational data from the AErosol RObotic NETwork (AERONET) in the Arctic and zonally. We find that MERRA2 satellite reanalysis is too high compared to the Sunphotometer measurements. Seasonal variation of AOD over the last 34 years was mostly not reproduced by the 12 CMIP6 models. CanESM5 and GFDL-CM4 simulated  AOD values within the MERRA2 variability during Arctic spring. MERRA2 reanalysis shows a decrease of AOD in the Northern Hemisphere since 1980. GFDL-ESM4 and GFDL-CM4 simulated the zonally averaged AOD within the MERRA2 reanalysis. NorESM-LM2 has too much sea salt in the Southern Hemisphere (50$^\circ$S) and too little AOD above 40$^\circ$N. Further work has to be done to clarify the contribution and representation of sea salt in NorESM-LM2.</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Introduction">Introduction<a class="anchor-link" href="#Introduction"> </a></h1><p>It has long been known that the Arctic region is particularly sensitive to global warming (Collins et al., 2013). Atmospheric Aerosols are particles suspended in the air. Some Aerosols have been produced by natural processes others by human activities. Aerosols in the Atmosphere reduce the amount of incoming solar radiation by scattering or absorbing light of solar radiation. The amount of atmospheric Aerosols varies with location, time and due to events such as dust storms, forest fires and volcanic eruptions (Lohmann et al., 2016). 
In a warming climate, will the sea ice decrease and larger areas of open water will follow an increase in organic aerosol uptake. Aerosols (natural or anthropogenic) can affect the Earth climate through interaction with solar radiation and clouds. Aerosol optical depth (AOD) is a measure of the amount of sunlight that has been scattered or absorbed.</p>
<p>The largest ground-based AOD measurement project is the AErosol RObotic NETwork (AERONET). The Sunphotometers are distributed over the globe and can give information about the distribution of aerosols in the atmosphere. This measurements are sparse and represent the AOD distribution only for a small area. With the launch of satellites, it is possible to retrieve global estimates of aerosol optical depth. Cloud free daily data can be used to reanalyse the AOD in a finer grid-scale and use it to validate global climate model performance to predict the changing climate more accurately.</p>
<p>Glantz et al., 2014  analysed the AOD in the Svalbard area. They compared Moderate Resolution Imaging Spectroradiometer (MODIS) Aqua retrievals of AOD to Sunphotometer measurements from Svalbard. The study shows that the Svalbard region undergoes a seasonal cycle with higher AOD during spring and a low AOD during summer. The remote sensing data is then used to examine the AOD generation of global climate models, represented in the Coupled Model Intercomparison Project 5 (CMIP5).  In the 1980 - 2014 period show the CMIP5 models an underestimation of AOD during spring and an overestimation during summer when compared to remote sensing data.</p>
<p>In the presented study nine years of Modern-Era Retrospective analysis for Research and Applications 2 (MERRA2), satellite reanalysis is compared to ground-based Sunphotometer AOD measurements in the Arctic. Afterwards, are climate model simulations from CMIP6 examined in comparison to MERRA2 satellite reanalysis over 34 years.</p>
<p>The following questions have been addressed:</p>
<ol>
<li>How representative are MERRA2 satellite reanalysis in comparison to the ground-based AOD observations in the Arctic?</li>
<li>How accurately does the global climate models of CMIP6 simulate the AOD for the Arctic and zonally for the last three decades?</li>
</ol>
<p><a href="#AERONET-Sunphotometer">Section 2.1</a> and <a href="#MERRA2">Section 2.2</a> contains the code to read the observational data from the Sunphotmeters and the MERRA2 satellite reanalysis in the Arctic region, respectively. <a href="#CMIP6">Section 2.3</a> consists of the code for finding the AOD at 550nm in the CMIP6 models and their ensembles. <a href="#Results-and-Discussion">Section 3</a> will then present the results to answer the questions above.</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Ground-based,-satellite-reanalysis-and-CMIP-model-data">Ground-based, satellite reanalysis and CMIP model data<a class="anchor-link" href="#Ground-based,-satellite-reanalysis-and-CMIP-model-data"> </a></h1><p>Global climate models are essential to study future climate changes of aerosols and clouds.<br>
Aerosol optical depth (AOD) at 550nm from Sunphotometer measurements from Aerosol Robotic Network (AERONET) is used as the reference to satellite retrieved reanalysis MERRA2. Then, AOD satellite reanalysis is utilised with comparable aerosol properties from historical Phase 6 of the CMIP6 model runs. The CMIP6 includes 33 participating model groups (Eyring et al., 2016) and data is available through the CMIP6 search interface <a href="https://esgf-data.dkrz.de/search/cmip6-dkrz/">https://esgf-data.dkrz.de/search/cmip6-dkrz/</a>. Of these 33 models, we focus on twelve models to evaluate the AOD. The model specifications can be found in <b>Table 1</b>.</p>
<center><font size=3> <b>Table 1:</b> List of CMIP6 models, AERONET Sunphotometer and MERRA2 AOD data used in this study. The version is the creation date of the CMIP6 data set and the Reference is accordingly to the model whereas the Identifier refers to the data reference.</font> </center><table>
<thead><tr>
<th></th>
<th style="text-align:center"><font size=3> Resolution </font></th>
<th style="text-align:center"></th>
<th style="text-align:center"><font size=3>Vertical levels</font></th>
<th style="text-align:right"><font size=3>Top level</font></th>
<th style="text-align:center"><font size=3> Version </font></th>
<th style="text-align:center"><font size=3> Time Range </font></th>
<th style="text-align:left"><font size=3> References </font></th>
<th style="text-align:left"><font size=3> Identifier </font> </th>
</tr>
</thead>
<tbody>
<tr>
<td></td>
<td style="text-align:center"></td>
<td style="text-align:center">(lat x lon)</td>
<td style="text-align:center">(nominal)</td>
<td style="text-align:right"></td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
<td style="text-align:left"></td>
<td style="text-align:left"></td>
</tr>
<tr>
<td>CanESM5</td>
<td style="text-align:center">2.8$^\circ$ x 2.8$^\circ$</td>
<td style="text-align:center">500 km</td>
<td style="text-align:center">49</td>
<td style="text-align:right">1 hPa</td>
<td style="text-align:center">2019-05-03</td>
<td style="text-align:center">1980 - 2014</td>
<td style="text-align:left">Swart et al., 2019</td>
<td style="text-align:left"><a href="http://doi.org/10.22033/ESGF/CMIP6.3610">10.22033/ESGF/CMIP6.3610</a></td>
</tr>
<tr>
<td>CESM2</td>
<td style="text-align:center">0.9$^\circ$ x 1.25$^\circ$</td>
<td style="text-align:center">100 km</td>
<td style="text-align:center">32</td>
<td style="text-align:right">2.25 hPa</td>
<td style="text-align:center">2019-01-16</td>
<td style="text-align:center">1980 - 2014</td>
<td style="text-align:left">NCAR CESM2, 2018</td>
<td style="text-align:left"><a href="http://doi.org/10.22033/ESGF/CMIP6.7627"> 10.22033/ESGF/CMIP6.7627</a></td>
</tr>
<tr>
<td>CESM2-WACCM</td>
<td style="text-align:center">0.9$^\circ$ x 1.3$^\circ$</td>
<td style="text-align:center">100 km</td>
<td style="text-align:center">70</td>
<td style="text-align:right">4.5x10$^{-6}$ hPa</td>
<td style="text-align:center">2019-01-30</td>
<td style="text-align:center">1980 - 2014</td>
<td style="text-align:left">NCAR CESM2, 2018</td>
<td style="text-align:left"><a href="http://doi.org/10.22033/ESGF/CMIP6.10071"> 10.22033/ESGF/CMIP6.10071</a></td>
</tr>
<tr>
<td>CNRM-CM6-1</td>
<td style="text-align:center">1.4$^\circ$ x 1.4$^\circ$</td>
<td style="text-align:center">250 km</td>
<td style="text-align:center">91</td>
<td style="text-align:right">0.01 hPa</td>
<td style="text-align:center">2018-06-20</td>
<td style="text-align:center">1980 - 2014</td>
<td style="text-align:left">Voldoire et al., 2019</td>
<td style="text-align:left"><a href="http://doi.org/10.22033/ESGF/CMIP6.4066"> 10.22033/ESGF/CMIP6.4066</a></td>
</tr>
<tr>
<td>E3SM-1-0</td>
<td style="text-align:center">1.0$^\circ$ x 1.0$^\circ$</td>
<td style="text-align:center">100 km</td>
<td style="text-align:center">72</td>
<td style="text-align:right">0.1 hPa</td>
<td style="text-align:center">2019-07-24</td>
<td style="text-align:center">1980 - 2014</td>
<td style="text-align:left">Golaz et al., 2019</td>
<td style="text-align:left"><a href="http://doi.org/10.22033/ESGF/CMIP6.4497"> 10.22033/ESGF/CMIP6.4497</a>   </td>
</tr>
<tr>
<td>GFDL-CM4</td>
<td style="text-align:center">1.0$^\circ$ x 1.2$^\circ$</td>
<td style="text-align:center">100 km</td>
<td style="text-align:center">33</td>
<td style="text-align:right">1 hPa</td>
<td style="text-align:center">2019-02-23</td>
<td style="text-align:center">1980 - 2014</td>
<td style="text-align:left">Held et al., 2019</td>
<td style="text-align:left"><a href="http://doi.org/10.22033/ESGF/CMIP6.8594">10.22033/ESGF/CMIP6.8594</a></td>
</tr>
<tr>
<td>GFDL-ESM4</td>
<td style="text-align:center">1.0$^\circ$ x 1.2$^\circ$</td>
<td style="text-align:center">100 km</td>
<td style="text-align:center">49</td>
<td style="text-align:right">0.01 hPa</td>
<td style="text-align:center">2019-08-06</td>
<td style="text-align:center">1980 - 2014</td>
<td style="text-align:left"></td>
<td style="text-align:left"><a href="https://doi.org/10.22033/ESGF/CMIP6.8597">10.22033/ESGF/CMIP6.8597<a/> </td>
</tr>
<tr>
<td>IPSL-CM6A-LR</td>
<td style="text-align:center">1.27$^\circ$ x 2.5$^\circ$</td>
<td style="text-align:center">250 km</td>
<td style="text-align:center">79</td>
<td style="text-align:right">40.000 m</td>
<td style="text-align:center">2018-07-11</td>
<td style="text-align:center">1980 - 2014</td>
<td style="text-align:left"></td>
<td style="text-align:left"><a href="http://doi.org/10.22033/ESGF/CMIP6.5195"> 10.22033/ESGF/CMIP6.5195</a></td>
</tr>
<tr>
<td>MIROC-ES2L</td>
<td style="text-align:center">2.8$^\circ$ x 2.8$^\circ$</td>
<td style="text-align:center">500 km</td>
<td style="text-align:center">40</td>
<td style="text-align:right">3 hPa</td>
<td style="text-align:center">2019-06-25</td>
<td style="text-align:center">1980 - 2014</td>
<td style="text-align:left">Hajima et al., 2019</td>
<td style="text-align:left"><a href="http://doi.org/10.22033/ESGF/CMIP6.5602"> 10.22033/ESGF/CMIP6.5602</a></td>
</tr>
<tr>
<td>MPI-ESM1-2-HR</td>
<td style="text-align:center">1.0$^\circ$ x 0.9$^\circ$</td>
<td style="text-align:center">100 km</td>
<td style="text-align:center">95</td>
<td style="text-align:right">0.01 hPa</td>
<td style="text-align:center">2019-08-25</td>
<td style="text-align:center">1980 - 2014</td>
<td style="text-align:left"></td>
<td style="text-align:left"><a href="http://doi.org/10.22033/ESGF/CMIP6.6594"> 10.22033/ESGF/CMIP6.6594</a></td>
</tr>
<tr>
<td>NorESM2-LM</td>
<td style="text-align:center">1.9$^\circ$ x 2.5$^\circ$</td>
<td style="text-align:center">250 km</td>
<td style="text-align:center">32</td>
<td style="text-align:right">3 hPa</td>
<td style="text-align:center">2019-08-15</td>
<td style="text-align:center">1980 - 2014</td>
<td style="text-align:left">Kirkevåg et al., 2018</td>
<td style="text-align:left"><a href=": http://cera-www.dkrz.de/WDCC/meta/CMIP6/CMIP6.CMIP.NCC.NorESM2-LM.historical"> NCC.NorESM2-LM.historical</a></td>
</tr>
<tr>
<td></td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
<td style="text-align:right"></td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
<td style="text-align:left"></td>
<td style="text-align:left"></td>
</tr>
<tr>
<td>Sunphotometer AERONET</td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
<td style="text-align:right"></td>
<td style="text-align:center"></td>
<td style="text-align:center">2006 - 2014</td>
<td style="text-align:left">Giles et al., 2019</td>
</tr>
<tr>
<td>MERRA2</td>
<td style="text-align:center">0.5$^\circ$ x 0.65$^\circ$</td>
<td style="text-align:center"></td>
<td style="text-align:center">72</td>
<td style="text-align:right">0.01 hPa</td>
<td style="text-align:center">5.12.4</td>
<td style="text-align:center">1980 - 2014</td>
<td style="text-align:left">Gelaro et al., 2017</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1">### Create dask cluster to work parallel in large datasets</span>

<span class="kn">from</span> <span class="nn">dask.distributed</span> <span class="k">import</span> <span class="n">Client</span>
<span class="n">client</span> <span class="o">=</span> <span class="n">Client</span><span class="p">(</span><span class="n">n_workers</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> 
                <span class="n">threads_per_worker</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> 
                <span class="n">memory_limit</span><span class="o">=</span><span class="s1">&#39;2GB&#39;</span><span class="p">,</span>
                <span class="n">processes</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">client</span>
<span class="n">chunks</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;time&#39;</span> <span class="p">:</span> <span class="mi">10</span><span class="p">,}</span>
<span class="n">client</span> 
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="jb_output_wrapper }}">
<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<table style="border: 2px solid white;">
<tr>
<td style="vertical-align: top; border: 0px solid white">
<h3 style="text-align: left;">Client</h3>
<ul style="text-align: left; list-style: none; margin: 0; padding: 0;">
  <li><b>Scheduler: </b>inproc://10.11.160.119/1570/1</li>
  <li><b>Dashboard: </b><a href='http://10.11.160.119/1570/1:8787/status' target='_blank'>http://10.11.160.119/1570/1:8787/status</a>
</ul>
</td>
<td style="vertical-align: top; border: 0px solid white">
<h3 style="text-align: left;">Cluster</h3>
<ul style="text-align: left; list-style:none; margin: 0; padding: 0;">
  <li><b>Workers: </b>2</li>
  <li><b>Cores: </b>4</li>
  <li><b>Memory: </b>4.00 GB</li>
</ul>
</td>
</tr>
</table>
</div>

</div>
</div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># supress warnings</span>
<span class="kn">import</span> <span class="nn">warnings</span>
<span class="n">warnings</span><span class="o">.</span><span class="n">filterwarnings</span><span class="p">(</span><span class="s1">&#39;ignore&#39;</span><span class="p">)</span> <span class="c1"># don&#39;t output warnings</span>

<span class="c1"># Import packages</span>
<span class="kn">from</span> <span class="nn">franzihe_imports</span> <span class="k">import</span> <span class="p">(</span><span class="n">xr</span><span class="p">,</span> <span class="n">plt</span><span class="p">,</span> <span class="n">np</span><span class="p">,</span> <span class="n">ccrs</span><span class="p">,</span> <span class="n">sns</span><span class="p">,</span> <span class="n">pd</span><span class="p">,</span> <span class="n">pya</span><span class="p">,</span> <span class="n">fct</span><span class="p">,</span> <span class="p">)</span>
<span class="kn">from</span> <span class="nn">glob</span> <span class="k">import</span> <span class="p">(</span><span class="n">glob</span><span class="p">)</span>
<span class="n">pya</span><span class="o">.</span><span class="n">change_verbosity</span><span class="p">(</span><span class="s1">&#39;critical&#39;</span><span class="p">,</span> <span class="n">log</span><span class="o">=</span><span class="n">pya</span><span class="o">.</span><span class="n">const</span><span class="o">.</span><span class="n">print_log</span><span class="p">)</span> 
<span class="n">pya</span><span class="o">.</span><span class="n">__version__</span>


<span class="c1"># reload imports</span>
<span class="o">%</span><span class="k">load_ext</span> autoreload
<span class="o">%</span><span class="k">autoreload</span> 2


<span class="c1"># Plotting cosmetics</span>
<span class="n">fct</span><span class="o">.</span><span class="n">plot_style</span><span class="p">()</span>

<span class="c1"># save figures to ./Figures/ folder</span>
<span class="n">savefig</span> <span class="o">=</span> <span class="mi">0</span>     <span class="c1"># 1 = yes, 0 = no</span>
</pre></div>

    </div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1">### Define data location for AERONET Sunphotometer, MERRA2 and CMIP6 </span>

<span class="n">pyaero_path</span> <span class="o">=</span> <span class="s1">&#39;shared-ns1000k/inputs/pyaerocom-testdata&#39;</span>
<span class="n">merra_path</span>  <span class="o">=</span> <span class="s1">&#39;data_MERRA2/&#39;</span>
<span class="n">cmip_path</span>   <span class="o">=</span> <span class="s1">&#39;shared-cmip6-for-ns1000k/historical/&#39;</span>
</pre></div>

    </div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="AERONET-Sunphotometer">AERONET Sunphotometer<a class="anchor-link" href="#AERONET-Sunphotometer"> </a></h2><p>I want to read in the AOD measured at 550nm by the Sunphotometer for the Arctic region. The definition for the Arctic region is latitudes larger than 66$^\circ$N.<br>
I will transform it into <code>xarry</code> since its functionality will make it easier for me to handle the data. Plotting is similar as in <code>pandas</code>. The function <code>read_aerocom_return_xarray_median_std</code> will help me to read in the station data with <a href="https://pyaerocom.met.no/">Pyaerocom</a>. The output will give the AOD at 550nm, the longitude and latitude, median and standard deviation for the Arctic stations. Most of the stations had a course data coverage, therefore, did I decide to use the years 2006 to 2014.</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># Pick out the stations for the Arctic</span>
<span class="c1"># Lat in decimal form</span>
<span class="n">lower_lat</span> <span class="o">=</span> <span class="mf">66.</span><span class="p">;</span> <span class="n">lower_lon</span> <span class="o">=</span> <span class="o">-</span><span class="mf">180.</span>
<span class="n">upper_lat</span> <span class="o">=</span> <span class="mf">90.</span><span class="p">;</span> <span class="n">upper_lon</span> <span class="o">=</span> <span class="mf">180.</span>
<span class="c1"># Pick out the years for analysis</span>
<span class="n">starty</span> <span class="o">=</span> <span class="s1">&#39;2006&#39;</span>
<span class="n">endy</span>   <span class="o">=</span> <span class="s1">&#39;2014&#39;</span>

<span class="c1"># AeroCom AOD values from Arctic stations</span>
<span class="n">aeronet_arctic</span> <span class="o">=</span> <span class="n">fct</span><span class="o">.</span><span class="n">read_aerocom_return_xarray_median_std</span><span class="p">(</span><span class="n">pyaero_path</span><span class="p">,</span> <span class="n">lower_lat</span><span class="p">,</span> <span class="n">upper_lat</span><span class="p">,</span> <span class="n">starty</span><span class="p">,</span> <span class="n">endy</span><span class="p">)</span>

<span class="c1"># only use AERONET stations which have data for starty and endy</span>
<span class="n">valid_aeronet_arctic</span> <span class="o">=</span> <span class="p">{}</span>
<span class="k">for</span> <span class="n">station_name</span> <span class="ow">in</span> <span class="n">aeronet_arctic</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">aeronet_arctic</span><span class="p">[</span><span class="n">station_name</span><span class="p">][</span><span class="s1">&#39;median_&#39;</span><span class="o">+</span><span class="n">starty</span><span class="o">+</span><span class="n">endy</span><span class="p">])</span> <span class="o">&lt;=</span> <span class="mi">0</span> <span class="ow">or</span> \
       <span class="nb">len</span><span class="p">(</span><span class="n">aeronet_arctic</span><span class="p">[</span><span class="n">station_name</span><span class="p">][</span><span class="s1">&#39;std_&#39;</span><span class="o">+</span><span class="n">starty</span><span class="o">+</span><span class="n">endy</span><span class="p">])</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">continue</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">valid_aeronet_arctic</span><span class="p">[</span><span class="n">station_name</span><span class="p">]</span> <span class="o">=</span> <span class="n">aeronet_arctic</span><span class="p">[</span><span class="n">station_name</span><span class="p">]</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">station_name</span><span class="p">,</span> 
              <span class="n">valid_aeronet_arctic</span><span class="p">[</span><span class="n">station_name</span><span class="p">][</span><span class="s1">&#39;latitude&#39;</span><span class="p">],</span> 
              <span class="n">valid_aeronet_arctic</span><span class="p">[</span><span class="n">station_name</span><span class="p">][</span><span class="s1">&#39;longitude&#39;</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="jb_output_wrapper }}">
<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>ARM_Oliktok_AK 70.4995 -149.88
Abisko 68.35000000000001 18.817000000000004
Andenes 69.27833299999998 16.008611
Barrow 71.31219999999998 -156.665
Hornsund 77.00148000000002 15.540279999999997
Ittoqqortoormiit 70.48479999999999 -21.9512
Kangerlussuaq 66.99580000000003 -50.6214
Ny_Alesund 78.929433 11.86085
OPAL 79.990278 -85.939167
PEARL 80.053611 -86.41694400000002
Resolute_Bay 74.70512299999999 -94.96940900000004
Sodankyla 67.36662 26.629569999999998
Thule 76.516102 -68.769001
Tiksi 71.58691699999999 128.921417
</pre>
</div>
</div>
</div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="MERRA2">MERRA2<a class="anchor-link" href="#MERRA2"> </a></h2><p>In <a href="#MERRA2-evaluation">Section 3.1</a>, the MERRA2 satellite reanalysis is evaluated against the ground-based AOD measurements to know how representative MERRA2 is for the Arctic stations. For this we used <a href="https://giovanni.gsfc.nasa.gov/giovanni/">NASAs GIOVANNI interface</a> to retrieve the monthly AOD averages for the stations. All MERRA2 data is the Aerosol Optical Depth at 550nm from MODIS. The processed analysis value is marked with <code>M2IMNXGAS</code>. 
We chose the grid box closest to the latitude and longitude of the AERONET stations in the Arctic.</p>
<p>The function <code>read_merra2_return_xarray_median_std</code> will read in the <code>.csv</code> files according to the station latitude and longitude from AERONET and returns a <code>xarray</code>. A monthly median and standard deviation is created for the AOD values to analyse the seasonal variability in <b> Fig. 2</b> for 2006 - 2014.</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># MERRA2 AOD values from Arctic stations</span>
<span class="n">_mfile</span> <span class="o">=</span> <span class="n">merra_path</span> <span class="o">+</span> <span class="s1">&#39;g4.areaAvgTimeSeries.M2IMNXGAS_5_12_4_AODANA.2006&#39;</span>
<span class="n">merra_arctic</span> <span class="o">=</span> <span class="n">fct</span><span class="o">.</span><span class="n">read_merra2_return_xarray_median_std</span><span class="p">(</span><span class="n">aeronet_arctic</span><span class="p">,</span> <span class="n">_mfile</span><span class="p">,</span> <span class="n">starty</span><span class="p">,</span> <span class="n">endy</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>MERRA2 satellite reanalysis has monthly averages of AOD from 1980. This values will be used to evaluate the CMIP6 historical simulations for the Arctic region (latitudes larger than 66$^\circ$N). The historical simulations help to evaluate the performance of the models against observations and provides insight into future projections.
The function <code>read_merra2</code> will return a <code>pandas</code> DataFrame.</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># Arctic 180W,66N - 180E,90N (1980-2014)</span>
<span class="n">_mfile</span> <span class="o">=</span> <span class="n">merra_path</span><span class="o">+</span> <span class="s1">&#39;g4.areaAvgTimeSeries.M2IMNXGAS_5_12_4_AODANA.19800101-20141231.180W_66N_180E_90N.csv&#39;</span>
<span class="n">merra_hist</span> <span class="o">=</span> <span class="n">fct</span><span class="o">.</span><span class="n">read_merra2</span><span class="p">(</span><span class="n">_mfile</span><span class="p">,</span> <span class="s1">&#39;mean_M2IMNXGAS_5_12_4_AODANA&#39;</span><span class="p">,</span> <span class="s1">&#39;M_Arctic&#39;</span> <span class="p">)</span>   
<span class="n">merra_hist</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="jb_output_wrapper }}">
<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>M_Arctic</th>
    </tr>
    <tr>
      <th>time</th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1980-01-01</th>
      <td>0.104969</td>
    </tr>
    <tr>
      <th>1980-02-01</th>
      <td>0.103549</td>
    </tr>
    <tr>
      <th>1980-03-01</th>
      <td>0.110453</td>
    </tr>
    <tr>
      <th>1980-04-01</th>
      <td>0.109904</td>
    </tr>
    <tr>
      <th>1980-05-01</th>
      <td>0.109821</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>
</div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>I also started analysing a region west of Svalbard against the ground-based station <b> Hornsund </b>. Therefore will this region be added to the <code>pandas.DataFrame</code>.</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># Nordic Sea, west of Svalbard 15W,75N - 10E,82N  </span>
<span class="n">_mfile</span> <span class="o">=</span> <span class="n">merra_path</span><span class="o">+</span> <span class="s1">&#39;g4.areaAvgTimeSeries.M2IMNXGAS_5_12_4_AODANA.19800101-20141231.15W_75N_10E_82N.csv&#39;</span>

<span class="n">merra_hist</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> 
                  <span class="n">column</span><span class="o">=</span><span class="s1">&#39;M_Svalbard&#39;</span><span class="p">,</span> 
                  <span class="n">value</span><span class="o">=</span><span class="n">fct</span><span class="o">.</span><span class="n">read_merra2</span><span class="p">(</span><span class="n">_mfile</span><span class="p">,</span> <span class="s1">&#39;mean_M2IMNXGAS_5_12_4_AODANA&#39;</span><span class="p">,</span> <span class="s1">&#39;M_Svalbard&#39;</span> <span class="p">)[</span><span class="s1">&#39;M_Svalbard&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>
<span class="n">merra_hist</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="jb_output_wrapper }}">
<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>M_Arctic</th>
      <th>M_Svalbard</th>
    </tr>
    <tr>
      <th>time</th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1980-01-01</th>
      <td>0.104969</td>
      <td>0.116562</td>
    </tr>
    <tr>
      <th>1980-02-01</th>
      <td>0.103549</td>
      <td>0.093377</td>
    </tr>
    <tr>
      <th>1980-03-01</th>
      <td>0.110453</td>
      <td>0.147553</td>
    </tr>
    <tr>
      <th>1980-04-01</th>
      <td>0.109904</td>
      <td>0.123854</td>
    </tr>
    <tr>
      <th>1980-05-01</th>
      <td>0.109821</td>
      <td>0.119110</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>
</div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>To make the plotting easier, later on, will I transfer the <code>pandas.DataFrame</code> to <code>xarray</code> for the Arctic and Svalbard region.</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># add to merra arctic xarray stations the Arctic area(180W-180E,66-90N) and </span>
<span class="c1"># the Svalbard area (15W-10E,75-82N)</span>

<span class="n">merra_arctic</span><span class="p">[</span><span class="s1">&#39;M_Arctic&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
<span class="n">merra_arctic</span><span class="p">[</span><span class="s1">&#39;M_Svalbard&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
<span class="n">merra_arctic</span><span class="p">[</span><span class="s1">&#39;M_Arctic&#39;</span><span class="p">][</span><span class="s1">&#39;od550aer&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">DataArray</span><span class="p">(</span><span class="n">merra_hist</span><span class="p">[</span><span class="s1">&#39;M_Arctic&#39;</span><span class="p">],</span> <span class="n">dims</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;time&#39;</span><span class="p">,])</span>
<span class="n">merra_arctic</span><span class="p">[</span><span class="s1">&#39;M_Svalbard&#39;</span><span class="p">][</span><span class="s1">&#39;od550aer&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">DataArray</span><span class="p">(</span><span class="n">merra_hist</span><span class="p">[</span><span class="s1">&#39;M_Svalbard&#39;</span><span class="p">],</span> <span class="n">dims</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;time&#39;</span><span class="p">,])</span>
</pre></div>

    </div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The Arctic AOD values are averaged to present the seasonal variability of MERRA2 data. <b> Fig. 1 </b> to <b> Fig. 3 </b> use monthly averages over several years to present this. <code>calc_xarray_median_std</code> will calculate the median for the stations and the Arctic region, 2006 - 2014 and 1980 - 2014, respectively.</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># median and std for 2006-2014</span>
<span class="n">merra_arctic</span><span class="p">[</span><span class="s1">&#39;M_Arctic&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">fct</span><span class="o">.</span><span class="n">calc_xarray_median_std_monthly</span><span class="p">(</span><span class="n">merra_arctic</span><span class="p">[</span><span class="s1">&#39;M_Arctic&#39;</span><span class="p">],</span><span class="s1">&#39;od550aer&#39;</span><span class="p">,</span> <span class="s1">&#39;2006&#39;</span><span class="p">,</span> <span class="s1">&#39;2014&#39;</span><span class="p">)</span>
<span class="c1"># median and std for 1980-2014</span>
<span class="n">merra_arctic</span><span class="p">[</span><span class="s1">&#39;M_Arctic&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">fct</span><span class="o">.</span><span class="n">calc_xarray_median_std_monthly</span><span class="p">(</span><span class="n">merra_arctic</span><span class="p">[</span><span class="s1">&#39;M_Arctic&#39;</span><span class="p">],</span><span class="s1">&#39;od550aer&#39;</span><span class="p">,</span> <span class="s1">&#39;1980&#39;</span><span class="p">,</span> <span class="s1">&#39;2014&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><b> Fig. 5 </b> will evaluate twelve CMIP6 models against MERRA2, zonally for three decades (1980s, 1990s, 2000s). The <a href="https://giovanni.gsfc.nasa.gov/giovanni/">NASA GIOVANNI interface</a> already provides a zonal mean for AOD at 550nm.
<code>read_merra2_zonal</code> will read the <code>.csv</code> files and returns a <code>dictonary</code> containing the <code>xarray</code> for each decade.</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># find zonal csv files</span>
<span class="n">fn_list</span> <span class="o">=</span> <span class="n">glob</span><span class="p">(</span><span class="n">merra_path</span><span class="o">+</span><span class="s1">&#39;g4.zonalMean.M2IMNXGAS_5_12_4_AODANA.*&#39;</span><span class="p">)</span>
<span class="n">fn_list</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>
<span class="n">fn_list</span>

<span class="c1"># read zonal files and assign to dictonary with xarray</span>
<span class="n">_dir</span> <span class="o">=</span> <span class="n">merra_path</span><span class="o">+</span><span class="s1">&#39;g4.zonalMean.M2IMNXGAS_5_12_4_AODANA.*&#39;</span>
<span class="c1">#merra_zonal = fct.read_merra2_zonal(_dir)</span>

<span class="n">_dir</span> <span class="o">=</span> <span class="n">merra_path</span><span class="o">+</span><span class="s1">&#39;g4.dimensionAveraged.M2IMNXGAS_5_12_4_AODANA.19800101-20141231.180W_90S_180E_90N.nc&#39;</span>
<span class="n">merra_zonal</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">open_dataset</span><span class="p">(</span><span class="n">_dir</span><span class="p">)</span>

<span class="c1"># calculate the media and standard deviation of each decade and all years</span>
<span class="n">merra_zonal</span> <span class="o">=</span> <span class="n">fct</span><span class="o">.</span><span class="n">calc_xarray_median_std_yearly</span><span class="p">(</span><span class="n">merra_zonal</span><span class="p">,</span> <span class="s1">&#39;M2IMNXGAS_5_12_4_AODANA&#39;</span><span class="p">,</span> <span class="s1">&#39;1980&#39;</span><span class="p">,</span> <span class="s1">&#39;1989&#39;</span><span class="p">)</span>
<span class="n">merra_zonal</span> <span class="o">=</span> <span class="n">fct</span><span class="o">.</span><span class="n">calc_xarray_median_std_yearly</span><span class="p">(</span><span class="n">merra_zonal</span><span class="p">,</span> <span class="s1">&#39;M2IMNXGAS_5_12_4_AODANA&#39;</span><span class="p">,</span> <span class="s1">&#39;1990&#39;</span><span class="p">,</span> <span class="s1">&#39;1999&#39;</span><span class="p">)</span>
<span class="n">merra_zonal</span> <span class="o">=</span> <span class="n">fct</span><span class="o">.</span><span class="n">calc_xarray_median_std_yearly</span><span class="p">(</span><span class="n">merra_zonal</span><span class="p">,</span> <span class="s1">&#39;M2IMNXGAS_5_12_4_AODANA&#39;</span><span class="p">,</span> <span class="s1">&#39;2000&#39;</span><span class="p">,</span> <span class="s1">&#39;2009&#39;</span><span class="p">)</span>
<span class="n">merra_zonal</span> <span class="o">=</span> <span class="n">fct</span><span class="o">.</span><span class="n">calc_xarray_median_std_yearly</span><span class="p">(</span><span class="n">merra_zonal</span><span class="p">,</span> <span class="s1">&#39;M2IMNXGAS_5_12_4_AODANA&#39;</span><span class="p">,</span> <span class="s1">&#39;1980&#39;</span><span class="p">,</span> <span class="s1">&#39;2014&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Information about the correlation between MERRA2 and the AERONET stations will be helpful to validate how representative the MERRA2 reanalysis is compared to the Arctic stations.
<code>calc_statistic</code> uses a function from <a href="https://pyaerocom.met.no/">Pyaerocom</a>, namely <code>pyaerocom.mathutils.calc_statistics</code>.  It will return all necessary values to analyse the correlation.</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">stat_arctic_st</span><span class="p">,</span> <span class="n">stat_arctic_merra</span> <span class="o">=</span> <span class="n">fct</span><span class="o">.</span><span class="n">calc_statistic</span><span class="p">(</span><span class="n">aeronet_arctic</span><span class="p">,</span> <span class="n">merra_arctic</span><span class="p">,</span> <span class="s1">&#39;2006&#39;</span><span class="p">,</span> <span class="s1">&#39;2014&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="CMIP6">CMIP6<a class="anchor-link" href="#CMIP6"> </a></h2><p>I did not know which CMIP6 historical simulations contain the AOD at 550nm in the <code>shared-cmip6-for-ns1000k</code> folder. Hence I want to find all models saved in the folder, which is done by using the <code>glob()</code> function, provided by the python glob package.</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">_hmd</span> <span class="o">=</span> <span class="n">glob</span><span class="p">(</span><span class="n">cmip_path</span><span class="o">+</span><span class="s1">&#39;/*&#39;</span><span class="p">)</span>
<span class="n">cmip6_model</span> <span class="o">=</span> <span class="p">[]</span>       <span class="c1"># find all model names of historical runs</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">_hmd</span><span class="p">)):</span> 
    <span class="n">cmip6_model</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">_hmd</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="nb">len</span><span class="p">(</span><span class="n">cmip_path</span><span class="p">):])</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;CMIP6 models containing AOD at 550nm&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="o">*</span><span class="n">cmip6_model</span><span class="p">,</span> <span class="n">sep</span> <span class="o">=</span> <span class="s1">&#39;,&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="jb_output_wrapper }}">
<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>CMIP6 models containing AOD at 550nm
AWI-CM-1-1-MR,IPSL-CM6A-LR,GISS-E2-1-G-CC,SAM0-UNICON,NorCPM1,NESM3,CESM2-WACCM,MCM-UA-1-0,NorESM2-LM,E3SM-1-0,CanESM5,CNRM-CM6-1-HR,UKESM1-0-LL,GISS-E2-1-H,FGOALS-f3-L,GFDL-ESM4,CAMS-CSM1-0,BCC-ESM1,GFDL-CM4,MIROC-ES2L,GISS-E2-1-G,EC-Earth3,BCC-CSM2-MR,MPI-ESM1-2-HR,HadGEM3-GC31-LL,EC-Earth3-Veg,CNRM-CM6-1,FGOALS-g3,MIROC6,CNRM-ESM2-1,CESM2,MRI-ESM2-0
</pre>
</div>
</div>
</div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>After returning all CMIP6 models, I will now search in the subfolders containing the AOD at 550nm.
For each model, monthly data from 1980 - 2014 is chosen to overlap with MERRA2. There are several ensembles and realisations available. I use the <code>r1i1p1f1</code>, <code>r1i1p2f1</code>, <code>r1i1p1f2</code> ensemble member, as it was available on the <code>shared-cmip6-for-ns1000k</code> folder.</p>
<p>Read all CMIP6 historical simulation including the AOD at 550nm (1980-2014) with <code>read_all_cmip6_od550aer</code>. The function will return a <code>dictionary</code> containing the model name and ensemble member. The longitude is shifted from originally 0-360$^\circ$ to 180$^\circ$W - 180$^\circ$E. Areacella values are added to the <code>xarray</code> to later calculate the weighted averages with the <code>masked_average</code> function (provided by assistants on <a href="https://nordicesmhub.github.io/NEGI-Abisko-2019/training/Example_model_global_arctic_average.html"> NEGI-2019 webpage</a>).</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">cmip</span> <span class="o">=</span> <span class="n">fct</span><span class="o">.</span><span class="n">read_all_cmip6_od550aer</span><span class="p">(</span><span class="n">cmip6_model</span><span class="p">,</span><span class="n">cmip_path</span><span class="p">,</span><span class="n">chunks</span><span class="p">,</span>
                                   <span class="n">lower_lat</span><span class="p">,</span> <span class="n">upper_lat</span><span class="p">,</span>
                                   <span class="n">lower_lon</span><span class="p">,</span> <span class="n">upper_lon</span><span class="p">,</span> <span class="s1">&#39;1980&#39;</span><span class="p">,</span> <span class="s1">&#39;2014&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>In this step, the weighted averages for each CMIP6 model and ensemble member are performed for chosen years and chosen region. First, I will evaluate the CMIP6 models in the Arctic region (latitude larger than 66$^\circ$N) between 1980 and 2014. The function <code>calc_weighted_av_median_std</code> will add to the existing <code>cmip</code> dictionary the weighted average for AOD as well as the monthly median and standard deviation for the chosen period.</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">starty</span><span class="o">=</span><span class="s1">&#39;1980&#39;</span><span class="p">;</span> <span class="n">endy</span><span class="o">=</span><span class="s1">&#39;2014&#39;</span>

<span class="c1"># calculate weighted mean, monthly mean and standard deviation for the Arctic</span>
<span class="k">for</span> <span class="n">model</span> <span class="ow">in</span> <span class="n">cmip</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
    <span class="k">for</span> <span class="n">rea</span> <span class="ow">in</span> <span class="n">cmip</span><span class="p">[</span><span class="n">model</span><span class="p">]</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
        <span class="n">cmip</span><span class="p">[</span><span class="n">model</span><span class="p">][</span><span class="n">rea</span><span class="p">]</span> <span class="o">=</span> <span class="n">fct</span><span class="o">.</span><span class="n">calc_weighted_av_median_std</span><span class="p">(</span><span class="n">cmip</span><span class="p">[</span><span class="n">model</span><span class="p">][</span><span class="n">rea</span><span class="p">],</span>
                                                           <span class="n">starty</span><span class="p">,</span> <span class="n">endy</span><span class="p">,</span> 
                                                           <span class="n">model</span><span class="p">,</span>
                                                           <span class="n">cmip</span><span class="p">[</span><span class="n">model</span><span class="p">][</span><span class="n">rea</span><span class="p">][</span><span class="s1">&#39;lat&#39;</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="p">(</span><span class="n">lower_lat</span><span class="o">-</span><span class="mi">5</span><span class="p">),</span>
                                                           <span class="p">[</span><span class="s1">&#39;lat&#39;</span><span class="p">,</span> <span class="s1">&#39;lon&#39;</span><span class="p">],</span> 
                                                           <span class="n">lower_lat</span><span class="p">,</span> <span class="n">upper_lat</span><span class="p">,</span>
                                                           <span class="n">lower_lon</span><span class="p">,</span> <span class="n">upper_lon</span><span class="p">,</span>
                                       <span class="p">)</span>
<span class="c1"># only use cmip data which have data for starty and endy and average to a monthly mean</span>
<span class="n">valid_cmip</span><span class="o">=</span><span class="p">{}</span>
<span class="k">for</span> <span class="n">model</span> <span class="ow">in</span> <span class="n">cmip</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
    <span class="n">valid_cmip</span><span class="p">[</span><span class="n">model</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">for</span> <span class="n">rea</span> <span class="ow">in</span> <span class="n">cmip</span><span class="p">[</span><span class="n">model</span><span class="p">]</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">cmip</span><span class="p">[</span><span class="n">model</span><span class="p">][</span><span class="n">rea</span><span class="p">][</span><span class="s1">&#39;median_&#39;</span><span class="o">+</span><span class="n">starty</span><span class="o">+</span><span class="n">endy</span><span class="p">]</span>
            <span class="n">valid_cmip</span><span class="p">[</span><span class="n">model</span><span class="p">][</span><span class="n">rea</span><span class="p">]</span> <span class="o">=</span> <span class="n">cmip</span><span class="p">[</span><span class="n">model</span><span class="p">][</span><span class="n">rea</span><span class="p">]</span>
        <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
            <span class="k">continue</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="jb_output_wrapper }}">
<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>no areacella data: 1980 - 2014 UKESM1-0-LL
no areacella data: 1980 - 2014 BCC-ESM1
no areacella data: 1980 - 2014 HadGEM3-GC31-LL
no areacella data: 1980 - 2014 CNRM-ESM2-1
</pre>
</div>
</div>
</div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><b> Fig. 4 </b> is analysing the AOD zonally against MERRA2. Weighted averages have to be created zonally for the CMIP historical simulations for each decade to make it comparable.</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">for</span> <span class="n">model</span> <span class="ow">in</span> <span class="n">cmip</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
    <span class="k">for</span> <span class="n">rea</span> <span class="ow">in</span> <span class="n">cmip</span><span class="p">[</span><span class="n">model</span><span class="p">]</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
        <span class="c1"># for 1980-1989</span>
        <span class="n">cmip</span><span class="p">[</span><span class="n">model</span><span class="p">][</span><span class="n">rea</span><span class="p">]</span>  <span class="o">=</span> <span class="n">fct</span><span class="o">.</span><span class="n">calc_weighted_av_median_std</span><span class="p">(</span><span class="n">cmip</span><span class="p">[</span><span class="n">model</span><span class="p">][</span><span class="n">rea</span><span class="p">],</span>
                                                            <span class="s1">&#39;1980&#39;</span><span class="p">,</span><span class="s1">&#39;1989&#39;</span><span class="p">,</span>
                                                            <span class="n">model</span><span class="p">,</span>
                                                            <span class="n">dim</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;lon&#39;</span><span class="p">])</span>
        <span class="c1"># for 1990-1999</span>
        <span class="n">cmip</span><span class="p">[</span><span class="n">model</span><span class="p">][</span><span class="n">rea</span><span class="p">]</span>  <span class="o">=</span> <span class="n">fct</span><span class="o">.</span><span class="n">calc_weighted_av_median_std</span><span class="p">(</span><span class="n">cmip</span><span class="p">[</span><span class="n">model</span><span class="p">][</span><span class="n">rea</span><span class="p">],</span>
                                                            <span class="s1">&#39;1990&#39;</span><span class="p">,</span><span class="s1">&#39;1999&#39;</span><span class="p">,</span>
                                                            <span class="n">model</span><span class="p">,</span>
                                                            <span class="n">dim</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;lon&#39;</span><span class="p">])</span>
        <span class="c1"># for 2000-2009</span>
        <span class="n">cmip</span><span class="p">[</span><span class="n">model</span><span class="p">][</span><span class="n">rea</span><span class="p">]</span>  <span class="o">=</span> <span class="n">fct</span><span class="o">.</span><span class="n">calc_weighted_av_median_std</span><span class="p">(</span><span class="n">cmip</span><span class="p">[</span><span class="n">model</span><span class="p">][</span><span class="n">rea</span><span class="p">],</span>
                                                            <span class="s1">&#39;2000&#39;</span><span class="p">,</span><span class="s1">&#39;2009&#39;</span><span class="p">,</span>
                                                            <span class="n">model</span><span class="p">,</span>
                                                            <span class="n">dim</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;lon&#39;</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="jb_output_wrapper }}">
<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>no areacella data: 1980 - 1989 UKESM1-0-LL
no areacella data: 1990 - 1999 UKESM1-0-LL
no areacella data: 2000 - 2009 UKESM1-0-LL
no areacella data: 1980 - 1989 BCC-ESM1
no areacella data: 1990 - 1999 BCC-ESM1
no areacella data: 2000 - 2009 BCC-ESM1
no areacella data: 1980 - 1989 HadGEM3-GC31-LL
no areacella data: 1990 - 1999 HadGEM3-GC31-LL
no areacella data: 2000 - 2009 HadGEM3-GC31-LL
no areacella data: 1980 - 1989 CNRM-ESM2-1
no areacella data: 1990 - 1999 CNRM-ESM2-1
no areacella data: 2000 - 2009 CNRM-ESM2-1
</pre>
</div>
</div>
</div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># get only the model keys for models which are used in the study</span>
<span class="n">_mm</span> <span class="o">=</span> <span class="p">[]</span> 
<span class="n">_rr</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">model</span> <span class="ow">in</span> <span class="n">valid_cmip</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">valid_cmip</span><span class="p">[</span><span class="n">model</span><span class="p">]</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">valid_cmip</span><span class="p">[</span><span class="n">model</span><span class="p">]</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span> <span class="o">&gt;=</span><span class="mi">1</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">rea</span> <span class="ow">in</span> <span class="n">valid_cmip</span><span class="p">[</span><span class="n">model</span><span class="p">]</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                <span class="n">_mm</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
                <span class="n">_rr</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">rea</span><span class="p">)</span>

                
</pre></div>

    </div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Results-and-Discussion">Results and Discussion<a class="anchor-link" href="#Results-and-Discussion"> </a></h1><p>As mentioned before, CMIP6 historical simulations will be evaluated against the satellite reanalysis product MERRA2. To have confidence in the analysis, the MERRA2 AODs are compared to the AERONET ground-based stations <a href="#MERRA2-evaluation">Section 3.1</a>. With a warming climate, the areas of open water will increase in the Arctic. Related to this will the sea-salt and organic aerosol discharge increase (Glantz et al., 2014). The Arctic undergoes a seasonal cycle of AOD. During the Arctic summer new particle formation occurs due to higher insolation $\rightarrow$ higher levels of OH and more efficient precipitation cleansing. <a href="#CMIP6-seasonal-evaluation">Section 3.2</a> will evaluate the CMIP6 seasonal cycle in the Arctic region between 1980 and 2014. The zonal assessment of CMIP6 models will then give an insight into how the models simulated the past three decades in a 'global' scale (<a href="#CMIP6-zonal-evaluation">Section 3.3</a>).</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="MERRA2-evaluation">MERRA2 evaluation<a class="anchor-link" href="#MERRA2-evaluation"> </a></h2><p>Seasonal AOD from the AERONET stations is compared to the MERRA2 reanalysis from 2006 to 2014 to determine how representative the fine resolution MERRA2 data is for the Arctic region.</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># Figure 1</span>
<span class="n">numfig</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">starty</span> <span class="o">=</span> <span class="s1">&#39;2006&#39;</span><span class="p">;</span> <span class="n">endy</span> <span class="o">=</span> <span class="s1">&#39;2014&#39;</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">[</span><span class="mi">30</span><span class="p">,</span><span class="mi">10</span><span class="p">])</span>
<span class="n">ax1</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">131</span><span class="p">,</span>
                      <span class="n">projection</span><span class="o">=</span> <span class="n">ccrs</span><span class="o">.</span><span class="n">AzimuthalEquidistant</span><span class="p">(</span><span class="n">central_longitude</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
                                                            <span class="n">central_latitude</span><span class="o">=</span><span class="mi">90</span><span class="p">,))</span>

<span class="n">ax2</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">132</span><span class="p">)</span>
<span class="n">ax3</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">133</span><span class="p">)</span>
<span class="k">for</span> <span class="n">station_name</span><span class="p">,</span> <span class="n">i</span>  <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">valid_aeronet_arctic</span><span class="o">.</span><span class="n">keys</span><span class="p">(),</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">valid_aeronet_arctic</span><span class="p">))):</span>
        <span class="c1"># Plot stations on map</span>
        <span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">valid_aeronet_arctic</span><span class="p">[</span><span class="n">station_name</span><span class="p">][</span><span class="s1">&#39;longitude&#39;</span><span class="p">],</span>
                 <span class="n">valid_aeronet_arctic</span><span class="p">[</span><span class="n">station_name</span><span class="p">][</span><span class="s1">&#39;latitude&#39;</span><span class="p">],</span>
                 <span class="s1">&#39;o&#39;</span><span class="p">,</span>
                 <span class="n">color</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">color_palette</span><span class="p">(</span><span class="s2">&quot;hls&quot;</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">valid_aeronet_arctic</span><span class="p">))[</span><span class="n">i</span><span class="p">],</span>
                 <span class="n">markersize</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span>
                 <span class="n">transform</span><span class="o">=</span><span class="n">ccrs</span><span class="o">.</span><span class="n">PlateCarree</span><span class="p">(),</span>
                 <span class="n">label</span><span class="o">=</span><span class="n">station_name</span><span class="p">)</span>
        <span class="n">ax1</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="n">station_name</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">3</span><span class="p">],</span> <span class="n">xy</span><span class="o">=</span><span class="p">(</span><span class="n">valid_aeronet_arctic</span><span class="p">[</span><span class="n">station_name</span><span class="p">][</span><span class="s1">&#39;longitude&#39;</span><span class="p">]</span><span class="o">+</span><span class="mf">0.15</span><span class="p">,</span> <span class="n">valid_aeronet_arctic</span><span class="p">[</span><span class="n">station_name</span><span class="p">][</span><span class="s1">&#39;latitude&#39;</span><span class="p">]</span><span class="o">+</span><span class="mf">0.15</span><span class="p">),</span> 
                     <span class="n">xycoords</span><span class="o">=</span><span class="n">ccrs</span><span class="o">.</span><span class="n">PlateCarree</span><span class="p">()</span><span class="o">.</span><span class="n">_as_mpl_transform</span><span class="p">(</span><span class="n">ax1</span><span class="p">),</span>
                    <span class="n">ha</span><span class="o">=</span><span class="s1">&#39;right&#39;</span><span class="p">,</span> <span class="n">va</span><span class="o">=</span><span class="s1">&#39;top&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
        <span class="c1"># Sunphotometer vs MERRA2 at stations</span>
        <span class="n">fct</span><span class="o">.</span><span class="n">plt_scatter</span><span class="p">(</span><span class="n">aeronet_arctic</span><span class="p">[</span><span class="n">station_name</span><span class="p">][</span><span class="s1">&#39;median_&#39;</span><span class="o">+</span><span class="n">starty</span><span class="o">+</span><span class="n">endy</span><span class="p">],</span>
                        <span class="n">merra_arctic</span><span class="p">[</span><span class="n">station_name</span><span class="p">][</span><span class="s1">&#39;median_&#39;</span><span class="o">+</span><span class="n">starty</span><span class="o">+</span><span class="n">endy</span><span class="p">][</span><span class="nb">int</span><span class="p">(</span><span class="n">aeronet_arctic</span><span class="p">[</span><span class="n">station_name</span><span class="p">][</span><span class="s1">&#39;median_&#39;</span><span class="o">+</span><span class="n">starty</span><span class="o">+</span><span class="n">endy</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">month</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span><span class="nb">int</span><span class="p">(</span><span class="n">aeronet_arctic</span><span class="p">[</span><span class="n">station_name</span><span class="p">][</span><span class="s1">&#39;median_&#39;</span><span class="o">+</span><span class="n">starty</span><span class="o">+</span><span class="n">endy</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">month</span><span class="p">)],</span>
                        <span class="p">[</span><span class="mf">0.015</span><span class="p">,</span><span class="mf">0.8</span><span class="p">],[</span><span class="mf">0.015</span><span class="p">,</span><span class="mf">0.8</span><span class="p">],</span>
                        <span class="s1">&#39;AOD$_</span><span class="si">{median}</span><span class="s1">$ Aeronet Sunphotometer (550nm)&#39;</span><span class="p">,</span> <span class="s1">&#39;AOD$_</span><span class="si">{median}</span><span class="s1">$ MERRA2 at stations (550nm)&#39;</span><span class="p">,</span>
                        <span class="n">stat_arctic_st</span><span class="p">,</span> 
                        <span class="s1">&#39;b)&#39;</span><span class="p">,</span> <span class="n">ax2</span><span class="p">,</span> <span class="n">sns</span><span class="o">.</span><span class="n">color_palette</span><span class="p">(</span><span class="s2">&quot;hls&quot;</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">valid_aeronet_arctic</span><span class="p">))[</span><span class="n">i</span><span class="p">])</span>
        <span class="c1"># MERRA2 Arctic median vs MERRA2 at stations</span>
        <span class="n">fct</span><span class="o">.</span><span class="n">plt_scatter</span><span class="p">(</span><span class="n">merra_arctic</span><span class="p">[</span><span class="s1">&#39;M_Arctic&#39;</span><span class="p">][</span><span class="s1">&#39;median_&#39;</span><span class="o">+</span><span class="n">starty</span><span class="o">+</span><span class="n">endy</span><span class="p">],</span>
                        <span class="n">merra_arctic</span><span class="p">[</span><span class="n">station_name</span><span class="p">][</span><span class="s1">&#39;median_&#39;</span><span class="o">+</span><span class="n">starty</span><span class="o">+</span><span class="n">endy</span><span class="p">],</span>
                        <span class="p">[</span><span class="mf">0.015</span><span class="p">,</span><span class="mf">0.8</span><span class="p">],[</span><span class="mf">0.015</span><span class="p">,</span><span class="mf">0.8</span><span class="p">],</span>
                        <span class="s1">&#39;AOD$_</span><span class="si">{median}</span><span class="s1">$ MERRA2 Arctic (550nm)&#39;</span><span class="p">,</span> <span class="s1">&#39;AOD$_</span><span class="si">{median}</span><span class="s1">$ MERRA2 at stations (550nm)&#39;</span><span class="p">,</span>
                        <span class="n">stat_arctic_merra</span><span class="p">,</span>
                        <span class="s1">&#39;c)&#39;</span><span class="p">,</span> <span class="n">ax3</span><span class="p">,</span> <span class="n">sns</span><span class="o">.</span><span class="n">color_palette</span><span class="p">(</span><span class="s2">&quot;hls&quot;</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">valid_aeronet_arctic</span><span class="p">))[</span><span class="n">i</span><span class="p">])</span>

<span class="c1"># Limit the map degrees latitude </span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_extent</span><span class="p">([</span><span class="o">-</span><span class="mi">180</span><span class="p">,</span> <span class="mi">180</span><span class="p">,</span> <span class="mi">90</span><span class="p">,</span> <span class="mi">60</span><span class="p">],</span> <span class="n">ccrs</span><span class="o">.</span><span class="n">PlateCarree</span><span class="p">())</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">coastlines</span><span class="p">()</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">gridlines</span><span class="p">()</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;a)&#39;</span><span class="p">,</span> <span class="n">fontweight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">)</span>


<span class="c1"># Legend</span>
<span class="n">ax3</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">bbox_to_anchor</span><span class="o">=</span><span class="p">(</span><span class="mf">1.1</span><span class="p">,</span> <span class="mf">1.05</span><span class="p">));</span>

<span class="k">if</span> <span class="n">savefig</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
    <span class="n">filename</span> <span class="o">=</span> <span class="s1">&#39;./Figures/AOD_station_correlation.png&#39;</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span><span class="c1">#transparent=True,</span>
                <span class="n">bbox_inches</span><span class="o">=</span><span class="s1">&#39;tight&#39;</span><span class="p">);</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="jb_output_wrapper }}">
<div class="output_area">



<div class="output_png output_subarea ">
<img src="../../images/topics/group-2/franzihe_area_averaged_AOD_Svalbard_35_0.png"
>
</div>

</div>
</div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<center><font size=3> <b>Fig. 1:</b> Monthly median for AOD at 550nm for 2006-2014. <b>a)</b> Aeronet stations above 66$^\circ$N. <b>b)</b>Aeronet Sunphotometer vs. MERRA2 for Arctic stations in corresponding colors. <b>c)</b> area averaged AOD for the Arctic region (180W-180E, 66-90N) vs. MERRA2 AOD at station gridbox. </font> </center>
</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>In <b>Fig. 1a)</b> we see valid measurement stations for AOD in the Arctic region between 2006 and 2014. The monthly medians of AOD at the stations are present in <b>Fig. 1b)</b>.  MERRA2 comparison on how well the AOD at the stations is in comparison to the Arctic area-averaged AOD shows in <b>Fig. 1c)</b>. The linear Pearson correlation coefficient for all stations is +0.3 (<b>Fig. 1b)</b>), meaning the data points are varying from the best fit and having a medium correlation. We also see that MERRA2 overestimates the monthly mean AOD. 
With this in mind, we compare the two MERRA2 data sets, <b>Fig. 1c)</b>. The correlation is large (R$_{Pearson}$ = 0.7), but not best. However, this result will give us later some confidence when we are analysing the CMIP6 historical simulations.</p>
<p>We want to see further how well the MERRA2 Arctic median compares to the AERONET ground-based measurements, in particular, the seasonal variation of AOD. Therefore monthly means for each station are plotted together with the MERRA2 data described in <a href="#MERRA2">Section 2.2</a>. The study focuses only on the summer months and on cloud-free days, where measurements at the AERONET station existed.</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># Figure 2</span>
<span class="n">starty</span> <span class="o">=</span> <span class="s1">&#39;2006&#39;</span><span class="p">;</span> <span class="n">endy</span> <span class="o">=</span> <span class="s1">&#39;2014&#39;</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">axsm</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">7</span><span class="p">,</span> <span class="n">sharex</span><span class="o">=</span><span class="s1">&#39;all&#39;</span><span class="p">,</span> <span class="n">sharey</span><span class="o">=</span><span class="s1">&#39;all&#39;</span><span class="p">,</span>
                         <span class="n">figsize</span> <span class="o">=</span> <span class="p">[</span><span class="mi">30</span><span class="p">,</span><span class="mi">10</span><span class="p">])</span>
<span class="n">axs</span> <span class="o">=</span> <span class="n">axsm</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span>
<span class="k">for</span> <span class="n">station_name</span><span class="p">,</span> <span class="n">i</span>  <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">valid_aeronet_arctic</span><span class="o">.</span><span class="n">keys</span><span class="p">(),</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">valid_aeronet_arctic</span><span class="p">))):</span>

        <span class="c1"># plot aeronet monthly median at station</span>
        <span class="n">fct</span><span class="o">.</span><span class="n">plt_seasonal_model_ensemble</span><span class="p">(</span><span class="n">valid_aeronet_arctic</span><span class="p">[</span><span class="n">station_name</span><span class="p">],</span> <span class="n">axs</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> 
                                        <span class="n">starty</span><span class="p">,</span> <span class="n">endy</span><span class="p">,</span>
                                        <span class="n">sns</span><span class="o">.</span><span class="n">color_palette</span><span class="p">(</span><span class="s2">&quot;hls&quot;</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">valid_aeronet_arctic</span><span class="p">))[</span><span class="n">i</span><span class="p">])</span>
        <span class="c1"># plot MERRA2 monthly median at station</span>
        <span class="n">fct</span><span class="o">.</span><span class="n">plt_seasonal_model_ensemble</span><span class="p">(</span><span class="n">merra_arctic</span><span class="p">[</span><span class="n">station_name</span><span class="p">],</span> <span class="n">axs</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> 
                                        <span class="n">starty</span><span class="p">,</span> <span class="n">endy</span><span class="p">,</span>
                                        <span class="s1">&#39;darkblue&#39;</span><span class="p">)</span>
        <span class="c1"># plot MERRA monthly median for Arctic</span>
        <span class="n">fct</span><span class="o">.</span><span class="n">plt_seasonal_model_ensemble</span><span class="p">(</span><span class="n">merra_arctic</span><span class="p">[</span><span class="s1">&#39;M_Arctic&#39;</span><span class="p">],</span> <span class="n">axs</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> 
                                        <span class="n">starty</span><span class="p">,</span> <span class="n">endy</span><span class="p">,</span>
                                        <span class="s1">&#39;k&#39;</span><span class="p">)</span>
        
        <span class="n">axs</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">station_name</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">sns</span><span class="o">.</span><span class="n">color_palette</span><span class="p">(</span><span class="s2">&quot;hls&quot;</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">valid_aeronet_arctic</span><span class="p">))[</span><span class="n">i</span><span class="p">],</span><span class="n">fontweight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">)</span>
        <span class="n">axs</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span><span class="mi">10</span><span class="p">])</span>
        <span class="n">axs</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.25</span><span class="p">])</span>
        <span class="n">axs</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">11</span><span class="p">))</span>
<span class="c1">#        axs[i].set_ylabel(&#39;AOD (550nm)&#39;)</span>
        <span class="n">axs</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
        <span class="n">axs</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span>

<span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;AOD (550nm)&#39;</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">7</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;AOD (550nm)&#39;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span><span class="mi">14</span><span class="p">):</span>
    <span class="n">axs</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Month&#39;</span><span class="p">)</span>


<span class="n">axs</span><span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="n">valid_aeronet_arctic</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">([</span><span class="s1">&#39;AERONET&#39;</span><span class="p">,</span> <span class="s1">&#39;MERRA2$_</span><span class="si">{Station}</span><span class="s1">$&#39;</span><span class="p">,</span> <span class="s1">&#39;MERRA2$_</span><span class="si">{Arctic}</span><span class="s1">$&#39;</span><span class="p">],</span>
                                        <span class="n">bbox_to_anchor</span><span class="o">=</span><span class="p">(</span><span class="mf">1.1</span><span class="p">,</span> <span class="mf">1.05</span><span class="p">),</span> <span class="n">loc</span><span class="o">=</span><span class="s1">&#39;lower left&#39;</span><span class="p">,</span> <span class="n">borderaxespad</span><span class="o">=</span><span class="mf">0.</span><span class="p">,</span> <span class="n">fancybox</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplots_adjust</span><span class="p">(</span><span class="n">wspace</span> <span class="o">=</span> <span class="mf">0.2</span><span class="p">,</span> <span class="n">hspace</span><span class="o">=</span><span class="mf">0.4</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%s</span><span class="s1"> - </span><span class="si">%s</span><span class="s1">, median and $\sigma$&#39;</span> <span class="o">%</span><span class="p">(</span><span class="n">starty</span><span class="p">,</span> <span class="n">endy</span><span class="p">),</span>
            <span class="n">fontsize</span><span class="o">=</span><span class="mi">28</span><span class="p">,</span><span class="n">fontweight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">);</span>

<span class="k">if</span> <span class="n">savefig</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
    <span class="n">filename</span> <span class="o">=</span> <span class="s1">&#39;./Figures/station_AERONET_MERRA2.png&#39;</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span><span class="c1">#transparent=True,</span>
                <span class="n">bbox_inches</span><span class="o">=</span><span class="s1">&#39;tight&#39;</span><span class="p">);</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="jb_output_wrapper }}">
<div class="output_area">



<div class="output_png output_subarea ">
<img src="../../images/topics/group-2/franzihe_area_averaged_AOD_Svalbard_38_0.png"
>
</div>

</div>
</div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<center><font size=3> <b>Fig. 2</b> Monthly median for AOD at 550nm between 2006-2014. Colored lines from the AERONET Sunphotometer at the station, blue: MERRA2 taken closest gridpoint to AERONET station, black: Arctic average.  </font> </center>
</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The coloured lines in <b>Fig. 2</b> represent the monthly medians from the AERONET stations between 2006 and 2014. Most of the ground-based observations show an AOD peak during spring, except Andenes (Norway) and Sodankyla (Finnland). The spring peak is likely associated with Arctic haze events. Arctic haze events are an occasionally enhanced Arctic aerosol loading by continental aerosols from midlatitudes. Furthermore, marine aerosols can have contributed to higher observed AOD due to the enhanced production by surface wind speeds during spring (Glantz et al., 2014).</p>
<p>Abisko (Sweden), Barrow (Alaska), Hornsund (Svalbard), Ittoqqortoormiit (Greenland) and Sodankyla (Finnland) show a peak during Arctic summer. From 2006 to 2014 was the Arctic highly influenced by aerosols from volcanic eruptions, such as Kasatochi (Alaska), Sarychev (Russia) and Nabro (Africa) in August 2008, July 2009 and June 2011, respectively. Furthermore, large agricultural fires in Eastern Europe and Canada resulted in an increase of AOD in the Arctic Region (Glantz et al., 2014).</p>
<p>Besides at the PEARL station (Northern Canda), none of the MERRA2 station data represents the seasonal cycle well.  In all cases is the satellite reanalysis too high in comparison to the ground-based measurements.</p>
<p>MERRA2 station AOD averages are lower compared to the Arctic average for 50% of the stations, namely Abisko (Sweden), Hornsund (Svalbard), Ittoqqortoormiit (Greenland), Kangerlussuaq (Greenland), Ny Ålesund (Svalbard), OPAL, PEARL (Northern Canada), Thule (Greenland).</p>
<p>For all stations, we have to keep in mind that I only focused on the months with daylight and cloud-free days for AERONET and MERRA2 measurements and reanalysis, respectively.</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="CMIP6-seasonal-evaluation">CMIP6 seasonal evaluation<a class="anchor-link" href="#CMIP6-seasonal-evaluation"> </a></h2><p>The previous finding will be helpful for the assessment of the CMIP6 historical simulations between 1980 and 2014. We have to keep in mind, that the seasonal variation of AOD for the Arctic region is only partly representative for the AERONET stations where MERRA2 showed almost everywhere too high values. Furthermore, the MERRA2 AOD at 550nm is always too high when compared to the ground-based observations.</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># Figure 3</span>
<span class="n">handles</span> <span class="o">=</span> <span class="p">{}</span>
<span class="n">starty</span> <span class="o">=</span> <span class="s1">&#39;1980&#39;</span><span class="p">;</span> <span class="n">endy</span>   <span class="o">=</span> <span class="s1">&#39;2014&#39;</span>
<span class="n">xtick_label</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Jan&#39;</span><span class="p">,</span> <span class="s1">&#39;Feb&#39;</span><span class="p">,</span> <span class="s1">&#39;Mar&#39;</span><span class="p">,</span> <span class="s1">&#39;Apr&#39;</span><span class="p">,</span> <span class="s1">&#39;May&#39;</span><span class="p">,</span> <span class="s1">&#39;Jun&#39;</span><span class="p">,</span> <span class="s1">&#39;Jul&#39;</span><span class="p">,</span> <span class="s1">&#39;Aug&#39;</span><span class="p">,</span> <span class="s1">&#39;Sep&#39;</span><span class="p">,</span> <span class="s1">&#39;Oct&#39;</span><span class="p">,</span> <span class="s1">&#39;Nov&#39;</span><span class="p">,</span> <span class="s1">&#39;Dec&#39;</span><span class="p">]</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">axsm</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span> <span class="n">sharex</span> <span class="o">=</span> <span class="s1">&#39;row&#39;</span><span class="p">,</span> <span class="n">sharey</span><span class="o">=</span><span class="s1">&#39;all&#39;</span><span class="p">,</span>
                       <span class="n">figsize</span><span class="o">=</span><span class="p">[</span><span class="mi">30</span><span class="p">,</span><span class="mi">10</span><span class="p">])</span>
<span class="n">axs</span> <span class="o">=</span> <span class="n">axsm</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span>

<span class="c1"># plot the MERRA2 seasonal cycle</span>
<span class="n">handles</span><span class="p">[</span><span class="s1">&#39;M_Arctic&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">fct</span><span class="o">.</span><span class="n">plt_seasonal_model_ensemble</span><span class="p">(</span><span class="n">merra_arctic</span><span class="p">[</span><span class="s1">&#39;M_Arctic&#39;</span><span class="p">],</span> <span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>  <span class="n">starty</span><span class="p">,</span> <span class="n">endy</span><span class="p">,</span><span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;MERRA2&#39;</span> <span class="p">)</span>
<span class="n">fct</span><span class="o">.</span><span class="n">plt_seasonal_model_ensemble</span><span class="p">(</span><span class="n">merra_arctic</span><span class="p">[</span><span class="s1">&#39;M_Arctic&#39;</span><span class="p">],</span> <span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>  <span class="n">starty</span><span class="p">,</span> <span class="n">endy</span><span class="p">,</span><span class="s1">&#39;k&#39;</span> <span class="p">)</span>
<span class="c1"># plot CMIP6 seasonal cycle</span>
<span class="k">for</span> <span class="n">model</span><span class="p">,</span> <span class="n">rea</span><span class="p">,</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">_mm</span><span class="p">[:</span><span class="nb">int</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">_mm</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">)],</span> <span class="n">_rr</span><span class="p">[:</span><span class="nb">int</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">_rr</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">)],</span> <span class="nb">range</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">_mm</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">))):</span>
    <span class="n">l1</span> <span class="o">=</span> <span class="n">fct</span><span class="o">.</span><span class="n">plt_seasonal_model_ensemble</span><span class="p">(</span><span class="n">valid_cmip</span><span class="p">[</span><span class="n">model</span><span class="p">][</span><span class="n">rea</span><span class="p">],</span> <span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">starty</span><span class="p">,</span> <span class="n">endy</span><span class="p">,</span> 
                                          <span class="n">sns</span><span class="o">.</span><span class="n">color_palette</span><span class="p">(</span><span class="s2">&quot;Paired&quot;</span><span class="p">,</span><span class="mi">12</span><span class="p">)[</span><span class="n">i</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="n">model</span><span class="o">+</span><span class="s1">&#39;_&#39;</span><span class="o">+</span><span class="n">rea</span><span class="p">)</span>
    
    <span class="n">handles</span><span class="p">[</span><span class="n">model</span><span class="o">+</span><span class="s1">&#39;_&#39;</span><span class="o">+</span><span class="n">rea</span><span class="p">]</span> <span class="o">=</span> <span class="n">l1</span>

<span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;AOD (550nm)&#39;</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mf">0.175</span><span class="p">])</span>


<span class="k">for</span> <span class="n">model</span><span class="p">,</span> <span class="n">rea</span><span class="p">,</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">_mm</span><span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">_mm</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">):],</span> <span class="n">_rr</span><span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">_rr</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">):],</span> <span class="nb">range</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">_mm</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">_mm</span><span class="p">))):</span>
    <span class="n">handles</span><span class="p">[</span><span class="n">model</span><span class="o">+</span><span class="s1">&#39;_&#39;</span><span class="o">+</span><span class="n">rea</span><span class="p">]</span> <span class="o">=</span> <span class="n">fct</span><span class="o">.</span><span class="n">plt_seasonal_model_ensemble</span><span class="p">(</span><span class="n">valid_cmip</span><span class="p">[</span><span class="n">model</span><span class="p">][</span><span class="n">rea</span><span class="p">],</span> <span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">starty</span><span class="p">,</span> <span class="n">endy</span><span class="p">,</span> 
                                          <span class="n">sns</span><span class="o">.</span><span class="n">color_palette</span><span class="p">(</span><span class="s2">&quot;Paired&quot;</span><span class="p">,</span><span class="mi">12</span><span class="p">)[</span><span class="n">i</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="n">model</span><span class="o">+</span><span class="s1">&#39;_&#39;</span><span class="o">+</span><span class="n">rea</span><span class="p">)</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">):</span>
    <span class="n">axs</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">12</span><span class="p">])</span>
    <span class="n">axs</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">13</span><span class="p">))</span>    
    <span class="n">axs</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">set_xticklabels</span><span class="p">(</span><span class="n">xtick_label</span><span class="p">,</span><span class="n">rotation</span> <span class="o">=</span> <span class="mi">55</span><span class="p">)</span>
    <span class="n">axs</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%s</span><span class="s1"> - </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span><span class="p">(</span><span class="n">starty</span><span class="p">,</span><span class="n">endy</span><span class="p">))</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span>

    
<span class="n">fig</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%s</span><span class="s1">W - </span><span class="si">%s</span><span class="s1">E, </span><span class="si">%s</span><span class="s1">N - </span><span class="si">%s</span><span class="s1">N, median and $\sigma$&#39;</span> <span class="o">%</span><span class="p">(</span><span class="n">lower_lon</span><span class="p">,</span><span class="n">upper_lon</span><span class="p">,</span><span class="n">lower_lat</span><span class="p">,</span><span class="n">upper_lat</span><span class="p">),</span>
            <span class="n">fontsize</span><span class="o">=</span><span class="mi">28</span><span class="p">,</span> <span class="n">fontweight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span> <span class="n">handles</span><span class="o">=</span><span class="n">handles</span><span class="o">.</span><span class="n">values</span><span class="p">(),</span> <span class="n">bbox_to_anchor</span><span class="o">=</span><span class="p">(</span><span class="mf">1.1</span><span class="p">,</span> <span class="mf">1.05</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplots_adjust</span><span class="p">(</span><span class="n">wspace</span> <span class="o">=</span> <span class="mf">0.15</span><span class="p">,</span>  
                    <span class="n">hspace</span> <span class="o">=</span> <span class="mf">0.15</span>   <span class="p">);</span>

<span class="k">if</span> <span class="n">savefig</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
    <span class="n">filename</span> <span class="o">=</span> <span class="s1">&#39;./Figures/seasonal_variation_MERRA2_CMIP6.png&#39;</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span><span class="c1">#transparent=True,</span>
                <span class="n">bbox_inches</span><span class="o">=</span><span class="s1">&#39;tight&#39;</span><span class="p">);</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="jb_output_wrapper }}">
<div class="output_area">



<div class="output_png output_subarea ">
<img src="../../images/topics/group-2/franzihe_area_averaged_AOD_Svalbard_42_0.png"
>
</div>

</div>
</div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<center><font size=3> <b>Fig. 3:</b> Monthly median for AOD at 550nm for the Arctic region between 1980-2014. Black: MERRA2 reanalysis, colours: CMIP6 models used in this study.  </font> </center>
</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><b>Fig. 3</b> shows the monthly median averages for AOD in the Arctic region between 1980-2014. The black line indicates the MERRA2 reanalysis with its variability in grey shading. As expected, is the MERRA2 variability of AOD largest in the Arctic winter during the polar night. Since AOD is measured optically it is not possible for the satellites (<a href="https://disc.gsfc.nasa.gov/information/glossary?keywords=giovanni%20measurements&title=Giovanni%20Measurement%20Definitions:%20Aerosol%20Optical%20Depth">MODIS</a>) to retrieve the AOD at 550nm during Arctic winter due to the lack of light. It also has to be taken into account, that AOD cannot be retrieved for cloudy days cloudy grid cells, and over snow/ice ground for MERRA2. Perhaps the MERRA2 values were interpolated from other wavelength retrieved by different satellites during winter.</p>
<p>We see in <b>Fig. 2</b> a seasonal variation of AOD at the stations and for MERRA2 data. In <b>Fig. 3</b> the MERRA2 reanalysis shows a peak of AOD during spring and summer and is for a longer average consistent with the seasonal cycle presented in <b>Fig. 2</b>. Here again, Arctic haze during spring, biogas burning and volcanic eruption come into play over the 1980 to 2014 period.</p>
<p>The coloured lines show the AOD from the CMIP6 model medians and their variability for the 34-year average. None of the here evaluated CMIP6 models simulates the AOD values during the summer month (June - August).</p>
<p>One CMIP6 model, namely, CanESM5 (red) catches one's eye. It simulates a distinct peak of AOD with large variability overlapping the MERRA2 reanalysis during Arctic spring for the 1980 - 2014 averages. On the other hand, the CanESM5 is too low during summer and not within the MERRA2 variability. A reason for the good simulation during spring can be an enhancement due to continental aerosols from midlatitudes and a higher amount of marine aerosols, driven by surface winds. 
The GFDL-ESM4 model (orange) is within the MERRA2 variability in the winter month until spring (September – March), but again too low during summer.</p>
<p>Glantz et al., 2014 studied the previous version of NorESM2-LM by validating it with MODIS satellite AOD measurements. The NorESM1-M CMIP5 model showed then too low values for AOD at 550nm. In <b>Fig. 3</b> we can see that NorESM-LM (light green) is almost constant over the year. E3SM-1-0, on the other hand, shows the best estimate of summer AOD, although too low compared to the measurements.</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="CMIP6-zonal-evaluation">CMIP6 zonal evaluation<a class="anchor-link" href="#CMIP6-zonal-evaluation"> </a></h2><p>The impact of anthropogenic emission can be seen for zonal averages.</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># Figure 4</span>
<span class="n">starty</span> <span class="o">=</span> <span class="s1">&#39;1980&#39;</span><span class="p">;</span> <span class="n">endy</span> <span class="o">=</span> <span class="s1">&#39;2014&#39;</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">[</span><span class="mi">20</span><span class="p">,</span><span class="mi">7</span><span class="p">])</span>
<span class="p">(</span><span class="n">merra_zonal</span><span class="p">[</span><span class="s1">&#39;median_&#39;</span><span class="o">+</span><span class="n">starty</span><span class="o">+</span><span class="n">endy</span><span class="p">]</span> <span class="o">-</span> <span class="n">merra_zonal</span><span class="p">[</span><span class="s1">&#39;M2IMNXGAS_5_12_4_AODANA&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="nb">slice</span><span class="p">(</span><span class="n">starty</span><span class="o">+</span><span class="s1">&#39;-01&#39;</span><span class="p">,</span><span class="n">endy</span><span class="o">+</span><span class="s1">&#39;-12&#39;</span><span class="p">))</span> <span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span>
                                                                                                             <span class="n">cmap</span><span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">get_cmap</span><span class="p">(</span><span class="s1">&#39;RdGy&#39;</span><span class="p">),</span>
                                                                                                             <span class="n">vmin</span><span class="o">=-</span><span class="mf">0.1</span><span class="p">,</span><span class="n">vmax</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span><span class="n">extend</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">,</span>
                                                                                                             <span class="n">robust</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                                                                                                             <span class="n">cbar_kwargs</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;ticks&quot;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="mf">0.1</span><span class="p">,</span><span class="mf">0.15</span><span class="p">,</span><span class="mf">0.05</span><span class="p">),</span>
                                                                                                                         <span class="s2">&quot;label&quot;</span><span class="p">:</span> <span class="s2">&quot;$\Delta$AOD (550nm)&quot;</span><span class="p">})</span>
<span class="n">xlabels</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;1980&#39;</span><span class="p">,</span> <span class="s1">&#39;1982&#39;</span><span class="p">,</span> <span class="s1">&#39;1984&#39;</span> <span class="p">,</span><span class="s1">&#39;1986&#39;</span><span class="p">,</span> <span class="s1">&#39;1988&#39;</span><span class="p">,</span> 
           <span class="s1">&#39;1990&#39;</span><span class="p">,</span> <span class="s1">&#39;1992&#39;</span><span class="p">,</span> <span class="s1">&#39;1994&#39;</span> <span class="p">,</span><span class="s1">&#39;1996&#39;</span><span class="p">,</span> <span class="s1">&#39;1998&#39;</span><span class="p">,</span>
           <span class="s1">&#39;2000&#39;</span><span class="p">,</span> <span class="s1">&#39;2002&#39;</span><span class="p">,</span> <span class="s1">&#39;2004&#39;</span> <span class="p">,</span><span class="s1">&#39;2006&#39;</span><span class="p">,</span> <span class="s1">&#39;2008&#39;</span><span class="p">,</span>
           <span class="s1">&#39;2010&#39;</span><span class="p">,</span> <span class="s1">&#39;2012&#39;</span><span class="p">,</span> <span class="s1">&#39;2014&#39;</span> <span class="p">,]</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Years&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">([</span><span class="s1">&#39;1980-01-01&#39;</span><span class="p">,</span> <span class="s1">&#39;2015-01-01&#39;</span><span class="p">])</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">(</span><span class="n">xlabels</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xticklabels</span><span class="p">(</span><span class="n">xlabels</span><span class="p">,</span><span class="n">rotation</span><span class="o">=</span><span class="mi">80</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Latitude (deg)&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">([</span><span class="o">-</span><span class="mi">90</span><span class="p">,</span><span class="mi">90</span><span class="p">])</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_yticks</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="mi">90</span><span class="p">,</span><span class="mi">120</span><span class="p">,</span><span class="mi">30</span><span class="p">))</span> 
<span class="n">ax</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="s1">&#39;1990-01-01&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="s1">&#39;2000-01-01&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="s1">&#39;2009-12-31&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;1980-2014 - AOD$_</span><span class="si">{year}</span><span class="s1">$&#39;</span><span class="p">);</span>

<span class="k">if</span> <span class="n">savefig</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
    <span class="n">filename</span> <span class="o">=</span> <span class="s1">&#39;./Figures/Hovemoeller_MERRA2.png&#39;</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span><span class="c1">#transparent=True,</span>
                <span class="n">bbox_inches</span><span class="o">=</span><span class="s1">&#39;tight&#39;</span><span class="p">);</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="jb_output_wrapper }}">
<div class="output_area">



<div class="output_png output_subarea ">
<img src="../../images/topics/group-2/franzihe_area_averaged_AOD_Svalbard_46_0.png"
>
</div>

</div>
</div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<center><font size=3> <b>Fig. 4:</b> Positive and negative anomalies of zonal averaged AOD. Red values (negative) indicate the increase in AOD and grey values (positive) illustrate the decrease of AOD compared to the 1980 - 2014 climatology. </font> </center>
</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The alteration of zonally averaged AOD compared to the 1980 - 2014 climatology shows in <b>Fig. 4</b>. Red shading represents an AOD increase. An AOD increase is globally distinct after the Mount Pinatubo eruption in June 1991 and consists for three years after. Generally shows <b>Fig. 4</b> a seasonal pattern with an AOD decrease in the tropics during winter and an increase during summer.</p>
<p>The winter months show a stronger decrease (red) of AOD in the Northern Hemispheric tropical zone (~up to 30$^\circ$N) when comparing the 2000s and 2010s to the late 1980s. On the other hand, the summer months show a stronger decrease of AOD in the mid- and high latitudes of the Northern Hemisphere. Increased production of anthropogenic aerosols leads to a decrease of AOD in the Northern Hemisphere since the 2000s.</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># Figure 5</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">axsm</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span> <span class="n">sharex</span> <span class="o">=</span> <span class="s1">&#39;all&#39;</span><span class="p">,</span> <span class="n">sharey</span><span class="o">=</span><span class="s1">&#39;all&#39;</span><span class="p">,</span>
                         <span class="n">figsize</span><span class="o">=</span><span class="p">[</span><span class="mi">28</span><span class="p">,</span><span class="mi">20</span><span class="p">])</span>
<span class="n">axs</span> <span class="o">=</span> <span class="n">axsm</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span>
<span class="n">starty</span> <span class="o">=</span><span class="s1">&#39;1980&#39;</span><span class="p">;</span> <span class="n">endy</span><span class="o">=</span><span class="s1">&#39;2014&#39;</span>

<span class="c1"># Plot MERRA median in each plot of the model</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">_mm</span><span class="p">)</span><span class="o">+</span><span class="mi">4</span><span class="p">):</span>
    <span class="n">merra_zonal</span><span class="p">[</span><span class="s1">&#39;median_&#39;</span><span class="o">+</span><span class="n">starty</span><span class="o">+</span><span class="n">endy</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span> <span class="o">=</span> <span class="n">axs</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span>
                                  <span class="n">label</span><span class="o">=</span><span class="s1">&#39;MERRA2 (</span><span class="si">%s</span><span class="s1">-</span><span class="si">%s</span><span class="s1">)&#39;</span> <span class="o">%</span><span class="p">(</span><span class="n">starty</span><span class="p">,</span><span class="n">endy</span><span class="p">))</span>
    <span class="n">axs</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">fill_between</span><span class="p">(</span><span class="n">merra_zonal</span><span class="p">[</span><span class="s1">&#39;median_&#39;</span><span class="o">+</span><span class="n">starty</span><span class="o">+</span><span class="n">endy</span><span class="p">]</span><span class="o">.</span><span class="n">lat</span><span class="p">,</span>
                           <span class="n">merra_zonal</span><span class="p">[</span><span class="s1">&#39;median_&#39;</span><span class="o">+</span><span class="n">starty</span><span class="o">+</span><span class="n">endy</span><span class="p">]</span> <span class="o">-</span> <span class="n">merra_zonal</span><span class="p">[</span><span class="s1">&#39;std_&#39;</span><span class="o">+</span><span class="n">starty</span><span class="o">+</span><span class="n">endy</span><span class="p">],</span>
                           <span class="n">merra_zonal</span><span class="p">[</span><span class="s1">&#39;median_&#39;</span><span class="o">+</span><span class="n">starty</span><span class="o">+</span><span class="n">endy</span><span class="p">]</span> <span class="o">+</span> <span class="n">merra_zonal</span><span class="p">[</span><span class="s1">&#39;std_&#39;</span><span class="o">+</span><span class="n">starty</span><span class="o">+</span><span class="n">endy</span><span class="p">],</span>
                           <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span> <span class="n">facecolor</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">)</span>   
<span class="c1"># Plot each decade in the subplots for MERRA and the CMIP models</span>
<span class="k">for</span> <span class="n">yr</span><span class="p">,</span> <span class="n">l_style</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">([</span><span class="s1">&#39;19801989&#39;</span><span class="p">,</span> <span class="s1">&#39;19901999&#39;</span><span class="p">,</span> <span class="s1">&#39;20002009&#39;</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="s1">&#39;:&#39;</span><span class="p">,</span> <span class="s1">&#39;-.&#39;</span><span class="p">]):</span>
    <span class="n">merra_zonal</span><span class="p">[</span><span class="s1">&#39;median_&#39;</span><span class="o">+</span><span class="n">yr</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">linestyle</span> <span class="o">=</span> <span class="n">l_style</span><span class="p">)</span>
    <span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">fill_between</span><span class="p">(</span><span class="n">merra_zonal</span><span class="p">[</span><span class="s1">&#39;median_&#39;</span><span class="o">+</span><span class="n">yr</span><span class="p">]</span><span class="o">.</span><span class="n">lat</span><span class="p">,</span>
                        <span class="n">merra_zonal</span><span class="p">[</span><span class="s1">&#39;median_&#39;</span><span class="o">+</span><span class="n">yr</span><span class="p">]</span> <span class="o">-</span> <span class="n">merra_zonal</span><span class="p">[</span><span class="s1">&#39;std_&#39;</span><span class="o">+</span><span class="n">yr</span><span class="p">],</span>
                        <span class="n">merra_zonal</span><span class="p">[</span><span class="s1">&#39;median_&#39;</span><span class="o">+</span><span class="n">yr</span><span class="p">]</span> <span class="o">+</span> <span class="n">merra_zonal</span><span class="p">[</span><span class="s1">&#39;std_&#39;</span><span class="o">+</span><span class="n">yr</span><span class="p">],</span>
                        <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>
    
    <span class="k">for</span> <span class="n">model</span><span class="p">,</span> <span class="n">rea</span><span class="p">,</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">_mm</span><span class="p">,</span> <span class="n">_rr</span><span class="p">,</span> <span class="nb">range</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">_mm</span><span class="p">)</span><span class="o">+</span><span class="mi">4</span><span class="p">)):</span>
    
        <span class="n">fct</span><span class="o">.</span><span class="n">plt_zonal_model_merra</span><span class="p">(</span><span class="n">axs</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">cmip</span><span class="p">[</span><span class="n">model</span><span class="p">][</span><span class="n">rea</span><span class="p">][</span><span class="s1">&#39;median_&#39;</span><span class="o">+</span><span class="n">yr</span><span class="p">],</span> 
                              <span class="n">cmip</span><span class="p">[</span><span class="n">model</span><span class="p">][</span><span class="n">rea</span><span class="p">][</span><span class="s1">&#39;std_&#39;</span><span class="o">+</span><span class="n">yr</span><span class="p">],</span>
                                  <span class="n">merra_zonal</span><span class="p">[</span><span class="s1">&#39;median_&#39;</span><span class="o">+</span><span class="n">starty</span><span class="o">+</span><span class="n">endy</span><span class="p">],</span> <span class="n">merra_zonal</span><span class="p">[</span><span class="s1">&#39;std_&#39;</span><span class="o">+</span><span class="n">starty</span><span class="o">+</span><span class="n">endy</span><span class="p">],</span>
                                  <span class="n">model</span><span class="p">,</span> <span class="n">sns</span><span class="o">.</span><span class="n">color_palette</span><span class="p">(</span><span class="s2">&quot;Paired&quot;</span><span class="p">,</span><span class="mi">12</span><span class="p">)[</span><span class="n">i</span><span class="o">-</span><span class="mi">4</span><span class="p">])</span>
        <span class="n">axs</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span><span class="k">model</span>, fontweight=&#39;bold&#39;)
     
        
    
    
<span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;MERRA2&#39;</span><span class="p">,</span> <span class="n">fontweight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">([</span><span class="s1">&#39;1980 - 1989&#39;</span><span class="p">,</span><span class="s1">&#39;1990 - 1999&#39;</span><span class="p">,</span> <span class="s1">&#39;2000 - 2009&#39;</span><span class="p">],</span><span class="n">bbox_to_anchor</span><span class="o">=</span><span class="p">(</span><span class="mf">1.1</span><span class="p">,</span> <span class="mf">1.05</span><span class="p">))</span><span class="c1"># loc=&#39;center right&#39;)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">4</span><span class="p">):</span>
    <span class="n">axs</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">16</span><span class="p">,</span><span class="mi">4</span><span class="p">):</span>
    <span class="n">axs</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;AOD (550nm)&#39;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">9</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">9</span><span class="p">,</span><span class="mi">13</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">13</span><span class="p">,</span><span class="mi">16</span><span class="p">)):</span>
    <span class="n">axs</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
    <span class="n">axs</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
    <span class="n">axs</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">12</span><span class="p">):</span>
    <span class="n">axs</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span><span class="mi">16</span><span class="p">):</span>
    <span class="n">axs</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Latitude (deg)&#39;</span><span class="p">)</span>
    <span class="n">axs</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">([</span><span class="o">-</span><span class="mi">90</span><span class="p">,</span><span class="mi">90</span><span class="p">])</span>
    <span class="n">axs</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="mi">90</span><span class="p">,</span><span class="mi">120</span><span class="p">,</span><span class="mi">30</span><span class="p">))</span>
    
<span class="n">plt</span><span class="o">.</span><span class="n">subplots_adjust</span><span class="p">(</span><span class="n">wspace</span> <span class="o">=</span> <span class="mf">0.2</span><span class="p">,</span>  
                    <span class="n">hspace</span> <span class="o">=</span> <span class="mf">0.2</span>   <span class="p">);</span>
<span class="k">if</span> <span class="n">savefig</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
    <span class="n">filename</span> <span class="o">=</span> <span class="s1">&#39;./Figures/zonal_CMIP6.png&#39;</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span><span class="c1">#transparent=True,</span>
                <span class="n">bbox_inches</span><span class="o">=</span><span class="s1">&#39;tight&#39;</span><span class="p">);</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="jb_output_wrapper }}">
<div class="output_area">



<div class="output_png output_subarea ">
<img src="../../images/topics/group-2/franzihe_area_averaged_AOD_Svalbard_49_0.png"
>
</div>

</div>
</div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<center><font size=3> <b>Fig. 5:</b> Zonal average of AOD for last three decades, 1980 - 1989, 1990 - 1999 and 2000 - 2009. The subfigures show the three decades simulated by the respective CMIP6 model. The black line in  subfigures is the MERRA2 zonal trend for 1980 - 2009.</font> </center>
</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><b>Fig. 5</b> upper panel shows the MERRA2 zonally averaged AOD for three decades, the 1980s, 1990s and 2000s. Around 60$^\circ$S we see the AOD dominated by sea salt, in the Tropics (15$^\circ$N) the influence by Saharan dust and the midlatitudes in the Northern Hemisphere influence by biogas burning and anthropogenic emissions. Especially in the Northern Hemisphere, we see a decrease of AOD in the mid- and higher latitudes (compare the 1980s to 2000s). <b>Fig. 5</b> second to the fourth row shows the MERRA2 zonally averaged AOD trend calculated for 1980-2014 and the CMIP6 models used in this study. In most of the CMIP6 models, we see no difference between the three decades.  Only CanESM5, GFDL-ESM4, GFDL-CM4, MIROC-ES2L and MPI-ESM1-2-HR show higher AOD for the 1980s above 30$^\circ$N (blue line).</p>
<p>Most of the here studied CMIP6 models underestimate the AOD in the mid- and high latitudes of the Northern Hemisphere, as already seen in the seasonal variation of the Arctic averaged AOD (<b>Fig. 3</b>). The CMIP6 GFDL models simulate the best zonal averaged AOD. The zonal average fits the variation of MERRA2 trend and is within the uncertainty of the reanalysis.</p>
<p>Most of the models have a small uncertainty for the three decades. CESM2-WACCM shows the largest variability compared to all CMIP6 models, especially in the Northern Hemisphere in the 1990s. The high variability might be associated with the volcanic forcing of the model during the Pinatubo eruption in 1991.
NorESM-LM does partly not follow the zonal trend reanalysed by MERRA2. NorESM-LM has high AOD values in the Southern Hemisphere. On the other hand, the AOD in the Northern Hemisphere above 40$^\circ$N is not within the uncertainty of the MERRA2 reanalysis and valid for all three decades. Sofie Tunes compares the relation between sea salt and wind at Ny Ålesund and the Zeppelin Station (Svalbard). Her work shows higher values of sea salt in NorESM2-LM for this specific location.  The question arises, if NorESM2-LM produces too much sea salt why is the AOD in the Arctic too low and almost does not show a seasonal variation of AOD in <b>Fig. 3</b>. Too much sea salt would mean more possible cloud condensation nuclei (CCN) will exist. Hence liquid water will be distributed equally over a larger number of CCNs. The cloud is then made up of smaller cloud droplets and will have a higher optical depth than clouds with fewer cloud droplets. Clouds with high optical depth will reflect more incoming radiation and could, therefore, have a cooling effect on the earth system (Lamb and Verlinde, 2011). 
But further studies should be carried out to find the reason for the high sea salt around 60$^\circ$S and on the other hand too little AOD in the Arctic. 
CanESM5 shows in <b>Fig. 3</b> a good agreement of AOD peak during the Arctic spring. CanESM5 simulates too low zonal averaged AOD in the tropics and subtropics and too high AOD in midlatitudes of the Northern Hemisphere. Compared to MERRA2, CanESM5 has a shifted AOD peak, instead of 15$^\circ$N at 40$^\circ$N. It agrees with the decadal trend seen with MERRA2, namely a decrease of AOD in the Northern Hemisphere (panel MERRA2 and CanESM5). 
The CMIP6 models MIROC-ES2L and CNRM-CM6-1 simulate almost no seasonal cycle for the Arctic in <b>Fig. 3</b>. Both these models underestimate the zonal AOD nearly everywhere. 
Too little aerosols mean more sunlight can reach the ground and hence, the global surface temperature increases.</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Summary-and-Conclusion">Summary and Conclusion<a class="anchor-link" href="#Summary-and-Conclusion"> </a></h1><p>In this project, I analysed how representative the MERRA2 satellite reanalysis is in comparison to the ground-based AOD Sunphotometers for Arctic stations. We used this further to see how representative a fine-scale Arctic average of MERRA2 reanalysis can be. The MERRA2 reanalysis helped us to do a seasonal intercomparison of 12 CMIP6 models for the Arctic region during 1980 - 2014. We analysed the CMIP6 models to the decadal change of zonally averaged AOD since 1980.
MERRA2 reanalysis is barely within the variability of the AERONET Sunphotometer observations and generally overestimates compared to the stations. Seasonal variation of Arctic AOD was reanalysed by MERRA2 with higher values during Arctic spring and summer. 
Sunphotometer observations are barely within the MERRA2 uncertainty, and further analysis has to be done to understand the higher values of MERRA2.</p>
<p>In average, the largest variability of AOD reanalysed by MERRA2 was seen during Arctic winter. The seasonal variation for monthly AOD average was mainly not reproduced by the CMIP6 models, as already seen for the CMIP5 models (Glantz et al., 2014). CanESM5 is within the range of MERRA2 during spring but on the other side too low in the summertime. GFDL-ESM4 is within the MERRA2 variability during winter and has a weak seasonal pattern. NorESM-LM shows a weak seasonal variation of AOD in the Arctic with the highest values during summer. E3SM-1-0 simulates the AOD during summer but is in general too weak compared to MERRA2 reanalysis.</p>
<p>The GFDL-ESM4 and GFDL-CM4 model fit zonally the best for all three decades. 
CESM2-WACCM had the highest variability in the Northern Hemisphere, especially the Arctic for all three decades. 
NorESM2-LM does not reproduce the AOD zonal averages as reanalysed by MERRA2. It produces too high sea salt in the Southern Hemisphere and too little AOD above 60$^\circ$N. 
CanESM5 reproduces the AOD pattern along the latitude, but the AOD peak in the Northern subtropics is shifted towards North with no peak in the tropics (Saharan dust) and too high AOD in the subtropics (human emissions and biogas burning).<br>
The two CMIP6 models MIROC-ES2L and CNRM-CM6-1 have too low AOD values zonally compared to the MERRA2 reanalysis.</p>
<p>A continuation of this work can be to analyse the different aerosol compounds in the vertical and how they differ between the CMIP6 models. Furthermore, an in-depth study of NorESM-LM should be implemented to find the reason for the high sea salt in the Southern Hemisphere and the low AOD in the Arctic. The MERRA2 reanalysis has to be more understood, especially how winter AOD is retrieved at high latitudes.</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Acknowledgement">Acknowledgement<a class="anchor-link" href="#Acknowledgement"> </a></h1><p>I would like to thank our group assistants Ksenia, and Paul who helped me with the MERRA2 data and the topic, and Jonas who made pyaerocom understandable. All the other assistants and teachers were also very helpful in particular, Sara who helped me with xarray and making my code more efficient. Thanks to Eemeli for helpful comments on my report.  Thanks to Anne for all the help on Jupyterhub and Github.</p>
<p>I also want to thank the CHESS research school on changing climates in the coupled earth system which made it possible to attend the course in Abisko.</p>
<p>This study was performed on Jupyterhub on resources provided by UNINETT Sigma2 - the National Infrastructure for High-Performance Computing and Data Storage in Norway as part of NS1000K project. Data was downloaded through <a href="https://giovanni.gsfc.nasa.gov/giovanni/">NASAs GIOVANNI interface</a>.</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="References">References<a class="anchor-link" href="#References"> </a></h1><p>Collins, M., Knutti, R., Arblaster, J., Dufresne, J.-L., Fichefet, T., Friedlingstein, P., Gao, X., Gutowski, W.J., Johns, T., Krinner, G., Shongwe, M., Tebaldi, C., Weaver, A.J., Wehner, M., 2013. Long-term Climate Change: Projections, Commitments and Irreversibility, in: Stocker, T.F., Qin, D., Plattner, G.-K., Tignor, M., Allen, S.K., Boschung, J., Nauels, A., Xia, Y., Bex, V., Midgley, P.M. (Eds.), Climate Change 2013: The Physical Science Basis. Contribution of Working Group I to the Fifth Assessment Report of the Intergovernmental Panel on Climate Change. Cambridge University Press, Cambridge, United Kingdom and New York, NY, USA, pp. 1029–1136. <a href="https://doi.org/10.1017/CBO9781107415324.024">https://doi.org/10.1017/CBO9781107415324.024</a></p>
<p>Eyring, V., Bony, S., Meehl, G.A., Senior, C.A., Stevens, B., Stouffer, R.J., Taylor, K.E., 2016. Overview of the Coupled Model Intercomparison Project Phase 6 (CMIP6) experimental design and organization. Geosci. Model Dev. 9, 1937–1958. <a href="https://doi.org/10.5194/gmd-9-1937-2016">https://doi.org/10.5194/gmd-9-1937-2016</a></p>
<p>Gelaro, R., McCarty, W., Suárez, M.J., Todling, R., Molod, A., Takacs, L., Randles, C.A., Darmenov, A., Bosilovich, M.G., Reichle, R., Wargan, K., Coy, L., Cullather, R., Draper, C., Akella, S., Buchard, V., Conaty, A., da Silva, A.M., Gu, W., Kim, G.-K., Koster, R., Lucchesi, R., Merkova, D., Nielsen, J.E., Partyka, G., Pawson, S., Putman, W., Rienecker, M., Schubert, S.D., Sienkiewicz, M., Zhao, B., 2017. The Modern-Era Retrospective Analysis for Research and Applications, Version 2 (MERRA-2). J. Climate 30, 5419–5454. <a href="https://doi.org/10.1175/JCLI-D-16-0758.1">https://doi.org/10.1175/JCLI-D-16-0758.1</a></p>
<p>Giles, D.M., Sinyuk, A., Sorokin, M.G., Schafer, J.S., Smirnov, A., Slutsker, I., Eck, T.F., Holben, B.N., Lewis, J.R., Campbell, J.R., Welton, E.J., Korkin, S.V., Lyapustin, A.I., 2019. Advancements in the Aerosol Robotic Network (AERONET) Version 3 database – automated near-real-time quality control algorithm with improved cloud screening for Sun photometer aerosol optical depth (AOD) measurements. Atmospheric Measurement Techniques 12, 169–209. <a href="https://doi.org/10.5194/amt-12-169-2019">https://doi.org/10.5194/amt-12-169-2019</a></p>
<p>Glantz, P., Bourassa, A., Herber, A., Iversen, T., Karlsson, J., Kirkevåg, A., Maturilli, M., Seland, Ø., Stebel, K., Struthers, H., Tesche, M., Thomason, L., 2014. Remote sensing of aerosols in the Arctic for an evaluation of global climate model simulations. Journal of Geophysical Research: Atmospheres 119, 8169–8188. <a href="https://doi.org/10.1002/2013JD021279">https://doi.org/10.1002/2013JD021279</a></p>
<p>Golaz, J.-C., Caldwell, P.M., Roekel, L.P.V., Petersen, M.R., Tang, Q., Wolfe, J.D., Abeshu, G., Anantharaj, V., Asay‐Davis, X.S., Bader, D.C., Baldwin, S.A., Bisht, G., Bogenschutz, P.A., Branstetter, M., Brunke, M.A., Brus, S.R., Burrows, S.M., Cameron‐Smith, P.J., Donahue, A.S., Deakin, M., Easter, R.C., Evans, K.J., Feng, Y., Flanner, M., Foucar, J.G., Fyke, J.G., Griffin, B.M., Hannay, C., Harrop, B.E., Hoffman, M.J., Hunke, E.C., Jacob, R.L., Jacobsen, D.W., Jeffery, N., Jones, P.W., Keen, N.D., Klein, S.A., Larson, V.E., Leung, L.R., Li, H.-Y., Lin, W., Lipscomb, W.H., Ma, P.-L., Mahajan, S., Maltrud, M.E., Mametjanov, A., McClean, J.L., McCoy, R.B., Neale, R.B., Price, S.F., Qian, Y., Rasch, P.J., Eyre, J.E.J.R., Riley, W.J., Ringler, T.D., Roberts, A.F., Roesler, E.L., Salinger, A.G., Shaheen, Z., Shi, X., Singh, B., Tang, J., Taylor, M.A., Thornton, P.E., Turner, A.K., Veneziani, M., Wan, H., Wang, H., Wang, S., Williams, D.N., Wolfram, P.J., Worley, P.H., Xie, S., Yang, Y., Yoon, J.-H., Zelinka, M.D., Zender, C.S., Zeng, X., Zhang, C., Zhang, K., Zhang, Y., Zheng, X., Zhou, T., Zhu, Q., 2019. The DOE E3SM Coupled Model Version 1: Overview and Evaluation at Standard Resolution. Journal of Advances in Modeling Earth Systems 11, 2089–2129. <a href="https://doi.org/10.1029/2018MS001603">https://doi.org/10.1029/2018MS001603</a></p>
<p>Hajima, T., Watanabe, M., Yamamoto, A., Tatebe, H., Noguchi, M.A., Abe, M., Ohgaito, R., Ito, Akinori, Yamazaki, D., Okajima, H., Ito, Akihiko, Takata, K., Ogochi, K., Watanabe, S., Kawamiya, M., 2019. Description of the MIROC-ES2L Earth system model and evaluation of its climate–biogeochemical processes and feedbacks. Geoscientific Model Development Discussions 1–73. <a href="https://doi.org/10.5194/gmd-2019-275">https://doi.org/10.5194/gmd-2019-275</a></p>
<p>Held, I.M., Guo, H., Adcroft, A., Dunne, J.P., Horowitz, L.W., Krasting, J., Shevliakova, E., Winton, M., Zhao, M., Bushuk, M., Wittenberg, A.T., Wyman, B., Xiang, B., Zhang, R., Anderson, W., Balaji, V., Donner, L., Dunne, K., Durachta, J., Gauthier, P.P.G., Ginoux, P., Golaz, J.-C., Griffies, S.M., Hallberg, R., Harris, L., Harrison, M., Hurlin, W., John, J., Lin, P., Lin, S.-J., Malyshev, S., Menzel, R., Milly, P.C.D., Ming, Y., Naik, V., Paynter, D., Paulot, F., Ramaswamy, V., Reichl, B., Robinson, T., Rosati, A., Seman, C., Silvers, L., Underwood, S., Zadeh, N., 2019. Structure and Performance of GFDL’s CM4.0 Climate Model. Journal of Advances in Modeling Earth Systems 0. <a href="https://doi.org/10.1029/2019MS001829">https://doi.org/10.1029/2019MS001829</a></p>
<p>Kirkevåg, A., Grini, A., Olivié, D., Seland, Ø., Alterskjær, K., Hummel, M., Karset, I.H.H., Lewinschal, A., Liu, X., Makkonen, R., Bethke, I., Griesfeller, J., Schulz, M., Iversen, T., 2018. A production-tagged aerosol module for Earth system models, OsloAero5.3 – extensions and updates for CAM5.3-Oslo. Geosci. Model Dev. 11, 3945–3982. <a href="https://doi.org/10.5194/gmd-11-3945-2018">https://doi.org/10.5194/gmd-11-3945-2018</a></p>
<p>Lamb, D., Verlinde, J., 2011. Physics and Chemistry of Clouds. Cambridge University Press, Cambridge. <a href="https://doi.org/10.1017/CBO9780511976377">https://doi.org/10.1017/CBO9780511976377</a></p>
<p>Lohmann, U., Luond, F., Mahrt, F., 2016. An Introduction to Clouds: From the Microscale to Climate. Cambridge University Press, Cambridge. <a href="https://doi.org/10.1017/CBO9781139087513">https://doi.org/10.1017/CBO9781139087513</a></p>
<p>NCAR CESM2, 2018. NCAR CESM2 model output prepared for CMIP6. Earth System Grid Federation. <a href="https://doi.org/10.5065/D67H1H0V">https://doi.org/10.5065/D67H1H0V</a></p>
<p>Swart, N.C., Cole, J.N.S., Kharin, V.V., Lazare, M., Scinocca, J.F., Gillett, N.P., Anstey, J., Arora, V., Christian, J.R., Hanna, S., Jiao, Y., Lee, W.G., Majaess, F., Saenko, O.A., Seiler, C., Seinen, C., Shao, A., Solheim, L., Salzen, K. von, Yang, D., Winter, B., 2019. The Canadian Earth System Model version 5 (CanESM5.0.3). Geoscientific Model Development Discussions 1–68. <a href="https://doi.org/10.5194/gmd-2019-177">https://doi.org/10.5194/gmd-2019-177</a></p>
<p>Voldoire, A., Saint‐Martin, D., Sénési, S., Decharme, B., Alias, A., Chevallier, M., Colin, J., Guérémy, J.-F., Michou, M., Moine, M.-P., Nabat, P., Roehrig, R., Mélia, D.S. y, Séférian, R., Valcke, S., Beau, I., Belamari, S., Berthet, S., Cassou, C., Cattiaux, J., Deshayes, J., Douville, H., Ethé, C., Franchistéguy, L., Geoffroy, O., Lévy, C., Madec, G., Meurdesoif, Y., Msadek, R., Ribes, A., Sanchez‐Gomez, E., Terray, L., Waldman, R., 2019. Evaluation of CMIP6 DECK Experiments With CNRM-CM6-1. Journal of Advances in Modeling Earth Systems 11, 2177–2213. <a href="https://doi.org/10.1029/2019MS001683">https://doi.org/10.1029/2019MS001683</a></p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">!</span>jupyter nbconvert --to html franzihe_area_averaged_AOD_V2.ipynb
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="jb_output_wrapper }}">
<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>[NbConvertApp] Converting notebook franzihe_area_averaged_AOD_V2.ipynb to html
[NbConvertApp] Writing 2686379 bytes to franzihe_area_averaged_AOD_V2.html
</pre>
</div>
</div>
</div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">!</span>jupyter nbconvert --to pdf franzihe_area_averaged_AOD_V2.ipynb
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="jb_output_wrapper }}">
<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>[NbConvertApp] Converting notebook franzihe_area_averaged_AOD_V2.ipynb to pdf
[NbConvertApp] Support files will be in franzihe_area_averaged_AOD_V2_files/
[NbConvertApp] Making directory ./franzihe_area_averaged_AOD_V2_files
[NbConvertApp] Making directory ./franzihe_area_averaged_AOD_V2_files
[NbConvertApp] Making directory ./franzihe_area_averaged_AOD_V2_files
[NbConvertApp] Making directory ./franzihe_area_averaged_AOD_V2_files
[NbConvertApp] Making directory ./franzihe_area_averaged_AOD_V2_files
[NbConvertApp] Writing 140368 bytes to ./notebook.tex
[NbConvertApp] Building PDF
[NbConvertApp] Running xelatex 3 times: [&#39;xelatex&#39;, &#39;./notebook.tex&#39;, &#39;-quiet&#39;]
[NbConvertApp] Running bibtex 1 time: [&#39;bibtex&#39;, &#39;./notebook&#39;]
[NbConvertApp] WARNING | bibtex had problems, most likely because there were no citations
[NbConvertApp] PDF successfully created
[NbConvertApp] Writing 1627438 bytes to franzihe_area_averaged_AOD_V2.pdf
</pre>
</div>
</div>
</div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">!</span>jupyter nbconvert --to markdown franzihe_area_averaged_AOD_V2.ipynb
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="jb_output_wrapper }}">
<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>[NbConvertApp] Converting notebook franzihe_area_averaged_AOD_V2.ipynb to markdown
[NbConvertApp] Support files will be in franzihe_area_averaged_AOD_V2_files/
[NbConvertApp] Making directory franzihe_area_averaged_AOD_V2_files
[NbConvertApp] Making directory franzihe_area_averaged_AOD_V2_files
[NbConvertApp] Making directory franzihe_area_averaged_AOD_V2_files
[NbConvertApp] Making directory franzihe_area_averaged_AOD_V2_files
[NbConvertApp] Making directory franzihe_area_averaged_AOD_V2_files
[NbConvertApp] Writing 62720 bytes to franzihe_area_averaged_AOD_V2.md
</pre>
</div>
</div>
</div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="ch">#!jupyter nbconvert --to html --template ./clean_output.tpl franzihe_area_averaged_AOD_V2.ipynb</span>
</pre></div>

    </div>
</div>
</div>

</div>
</div>

 


    </main>
    
            </div>
            <nav class="c-page__nav">
  
    
    <a id="js-page__nav__prev" class="c-page__nav__prev" href="/NEGI-Abisko-2019/topics/group-2/lassekva.html">
      〈 <span class="u-margin-right-tiny"></span> lassekva Project
    </a>
  

  
    
    <a id="js-page__nav__next" class="c-page__nav__next" href="/NEGI-Abisko-2019/topics/group-2/franzihe_intermediate_pres.html">
      Franzihe presentation <span class="u-margin-right-tiny"></span> 〉
    </a>
  
</nav>

            <footer>
  <p class="footer">This page was created by <a href="https://github.com/jupyter/jupyter-book/graphs/contributors">The Jupyter Book Community</a></p>
</footer>

        </div>
      </main>
    </div>
  </body>
</html>
